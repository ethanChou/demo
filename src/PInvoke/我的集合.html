<!DOCTYPE html>
<!-- saved from url=(0084)http://pabprod.blob.core.windows.net/books/dc7c5ee7-c17b-4152-925f-b3937386a2b5.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>我的集合</title><!--<base href="http://msdn.microsoft.com/">--><base href="."><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"ttf": "https://i-msdn.sec.s-msft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/zh-cn/library/e8w969hb(d=printer,l=zh-cn,v=vs.110).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'zh-cn';
  var wtsp = 'msdnlib_dotnet';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_1 && MTPS._injectNextScript_1(); }</script><script src="./我的集合_files/wtid.js"></script><script class="mtps-injected">try {
//

        window.appInsightsId = '5eb1b2eb-c47a-497a-a7ac-a1c230b2882f';
        //
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected" src="./我的集合_files/Combined.js"></script><script class="mtps-injected" src="./我的集合_files/SearchBox.jss"></script><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"ttf": "https://i-msdn.sec.s-msft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/zh-cn/library/883be1k5(d=printer,l=zh-cn,v=vs.110).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'zh-cn';
  var wtsp = 'msdnlib_dotnet';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_1 && MTPS._injectNextScript_1(); }</script><script src="./我的集合_files/wtid.js"></script><script class="mtps-injected">try {
//

        window.appInsightsId = '5eb1b2eb-c47a-497a-a7ac-a1c230b2882f';
        //
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected" src="./我的集合_files/Combined.js"></script><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"ttf": "https://i-msdn.sec.s-msft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/zh-cn/library/eshywdt7(d=printer,l=zh-cn,v=vs.110).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'zh-cn';
  var wtsp = 'msdnlib_dotnet';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_1 && MTPS._injectNextScript_1(); }</script><script src="./我的集合_files/wtid.js"></script><script class="mtps-injected">try {
//

        window.appInsightsId = '5eb1b2eb-c47a-497a-a7ac-a1c230b2882f';
        //
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected" src="./我的集合_files/Combined(1).js"></script><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"ttf": "https://i-msdn.sec.s-msft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/zh-cn/library/hk9wyw21(d=printer,l=zh-cn,v=vs.110).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'zh-cn';
  var wtsp = 'msdnlib_dotnet';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_1 && MTPS._injectNextScript_1(); }</script><script src="./我的集合_files/wtid.js"></script><script class="mtps-injected">try {
//

        window.appInsightsId = '5eb1b2eb-c47a-497a-a7ac-a1c230b2882f';
        //
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected" src="./我的集合_files/Combined(1).js"></script><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"ttf": "https://i-msdn.sec.s-msft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/zh-cn/library/5zwkzwf4(d=printer,l=zh-cn,v=vs.110).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'zh-cn';
  var wtsp = 'msdnlib_dotnet';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_1 && MTPS._injectNextScript_1(); }</script><script src="./我的集合_files/wtid.js"></script><script class="mtps-injected">try {
//

        window.appInsightsId = '5eb1b2eb-c47a-497a-a7ac-a1c230b2882f';
        //
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected" src="./我的集合_files/Combined.js"></script><script class="mtps-injected" src="./我的集合_files/Combined(2).js"></script><script class="mtps-injected" src="./我的集合_files/SearchBox.jss"></script><script class="mtps-injected" src="./我的集合_files/SearchBox.jss"></script><script class="mtps-injected" src="./我的集合_files/SearchBox.jss"></script><script class="mtps-injected" src="./我的集合_files/SearchBox.jss"></script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_6 && MTPS._injectNextScript_6(); }</script><script class="mtps-injected" src="./我的集合_files/Combined(3).js"></script><script class="mtps-injected" src="./我的集合_files/Combined(2).js"></script><script class="mtps-injected" src="./我的集合_files/Combined(4).js"></script><script class="mtps-injected" src="./我的集合_files/Combined(4).js"></script><script class="mtps-injected" src="./我的集合_files/Combined(2).js"></script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_8 && MTPS._injectNextScript_8(); }</script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_6 && MTPS._injectNextScript_6(); }</script><script class="mtps-injected" src="./我的集合_files/Combined(3).js"></script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_6 && MTPS._injectNextScript_6(); }</script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_7 && MTPS._injectNextScript_7(); }</script><script class="mtps-injected" src="./我的集合_files/Combined(5).js"></script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_6 && MTPS._injectNextScript_6(); }</script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_7 && MTPS._injectNextScript_7(); }</script><script class="mtps-injected" src="./我的集合_files/Combined(5).js"></script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_6 && MTPS._injectNextScript_6(); }</script><script class="mtps-injected" src="./我的集合_files/Combined(3).js"></script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_8 && MTPS._injectNextScript_8(); }</script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_9 && MTPS._injectNextScript_9(); }</script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_9 && MTPS._injectNextScript_9(); }</script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_8 && MTPS._injectNextScript_8(); }</script></head><body>
        <link href="./我的集合_files/PrintBook.css" rel="stylesheet" type="text/css">    <div class="BookHeader"><div class="BookTitleHeading">我的集合</div><div class="PabLogo"><a href="http://msdn.microsoft.com/" title="Microsoft Developer Network"><img alt="Microsoft Developer Network" src="./我的集合_files/BrandLogoMsdn.png"></a></div><div style="clear: both"></div><div class="pageBlank"><div class="pageFooter"><hr class="pageFooterSeparater">本文档将按"原样"提供。文档中所陈述的信息和观点，包括 URL 和其他 Internet 网站参考，如有更改，恕不另行通知。本文档不向您提供有关任何 Microsoft 产品或产品名称中的任何知识产权的合法权利。您可以在内部复制并使用本文档以进行参考。您可以在内部修改本文档以进行参考。© 2016 Microsoft. 版权所有。保留所有权利。使用条款 (https://msdn.microsoft.com/cc300389.aspx) | 商标 (http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx)</div></div></div><p style="page-break-before: always"></p><div class="TableOfContents"><hr class="pageSplitter"><div class="TableOfContentsTitle">Table Of Contents</div><div class="ChapterName">第 1 章</div><div><a href="https://msdn.microsoft.com/zh-cn/library/e8w969hb(v=vs.110).aspx" class="TopicLink">封送处理字符串</a></div><div><a href="https://msdn.microsoft.com/zh-cn/library/883be1k5(v=vs.110).aspx" class="TopicLink">MsgBox 示例</a></div><div><a href="https://msdn.microsoft.com/zh-cn/library/eshywdt7(v=vs.110).aspx" class="TopicLink">封送类、结构和联合</a></div><div><a href="https://msdn.microsoft.com/zh-cn/library/hk9wyw21(v=vs.110).aspx" class="TopicLink">封送处理不同类型的数组</a></div><div><a href="https://msdn.microsoft.com/zh-cn/library/5zwkzwf4(v=vs.110).aspx" class="TopicLink">将委托作为回调方法进行封送</a></div><div class="chapterSplitter"></div><div style="clear: both"></div></div><p style="page-break-before: always"></p>
<hr class="pageSplitter"><div class="ChapterTitle">第 1 章</div>
<link rel="stylesheet" type="text/css" href="./我的集合_files/Combined.css">
    <div id="page">

        

        
    

    
    <link type="text/css" rel="stylesheet">
    
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn">
        

      <header>
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/zh-cn" title="MSDN home">
                  <div id="msft-logo" class="msft-logo"></div>
                </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/zh-cn">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <div class="profileImage"></div>



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=12&ct=1464504562&rver=6.0.5276.0&wp=mcmbi&wlcxt=msdn%24msdn%24msdn&wreply=https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2fe8w969hb%2528d%3dprinter%2cv%3dvs.110%2529.aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook&lc=2052&id=254354&mkt=zh-cn">登录</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">MSDN 订阅</span>
  </a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x804&slcid=0x804&campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">获取工具</span>
  </a>
</div>
                  </div>                    
                        <div>
                            <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.weibo.com/cnmsdn" id="SocialLinks_2152_8" class="weiboShare" xmlns="http://www.w3.org/1999/xhtml">http://www.weibo.com/cnmsdn</a>
      </li>
      <li>
        <a href="http://aka.ms/msdnwechat" id="SocialLinks_2152_9" class="wechatShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/msdnwechat</a>
      </li>
      <li>
        <a href="http://aka.ms/contactmsdn" id="SocialLinks_2152_10" class="cnContactShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/contactmsdn</a>
      </li>
    </ul>
  </div>
</div>
                        </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">技术</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="云">云</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="应用开发">应用开发</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="数据">数据</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="游戏">游戏</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/internetofthings" title="物联网">物联网</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">下载</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions/" title="MSDN 订阅访问">MSDN 订阅访问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDK">SDK</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="试用软件">试用软件</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="免费下载">免费下载</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office 资源">Office 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 资源">SharePoint Server 2013 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express 资源">SQL Server 2014 Express 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 资源">Windows Server 2012 资源</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">计划</a>
                                <ul class="navL2">
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN 订阅">MSDN 订阅</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="权益">权益</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="学生">学生</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft 学生合作伙伴">Microsoft 学生合作伙伴</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="架构师">架构师</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="案例研究">案例研究</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="蓝图">蓝图</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="博客">博客</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="论坛">论坛</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/applicationbuilder" title="ISV">ISV</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="新手">新手</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="TechRewards">TechRewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/zh-cn" title="Events（事件）">Events（事件）</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">社区</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="论坛">论坛</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://blogs.msdn.microsoft.com/" title="博客">博客</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/zh-cn" title="技术顾问">技术顾问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="第 9 频道">第 9 频道</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)">文档</a>
                                <ul class="navL2">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="API 和参考">API 和参考</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="开发人员中心">开发人员中心</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/">示例</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)">
      </div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    </div>

    
    
    
    <div id="jumpInfo" style="display: none">非常抱歉。你请求的内容已被删除。将在 1 秒内自动重定向。</div>


    
    <div class="printExportMenus ltr">
        <a id="isd_printABook" href="http://msdn.microsoft.com/zh-cn/library/export/help/(d=printer)?returnurl=%2fzh-cn%2flibrary%2fe8w969hb(d%3dprinter,v%3dvs.110).aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook">
            导出 (<span class="count">0</span>)
        </a>
        <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/e8w969hb(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book" rel="nofollow">
            打印
        </a>
        <a id="isd_archiveControl" style="display:none;" data-include-archive="显示已存档版本" data-exclude-archive="隐藏已存档版本">
        </a>
    </div>
    
    <div class="printExportMenus ltr">
        <a id="expandCollapseAll" accesskey="e" href="javascript:void(0)" title="Expand/Collapse all sections by pressing Ctrl + Shift + e">全部展开</a>
    </div>

    


        <div id="body" ms.pgarea="body">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="content" class="content">



<input type="hidden" id="printForPab" value="true">



        
<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">封送处理字符串</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong>
                .NET Framework (current version)
            </strong>
      </div>
      <div id="versionclick">
        <div id="vsseperator" class="cl_lw_vs_seperator"></div>
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        其他版本
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./我的集合_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel">
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/e8w969hb(d=printer,v=vs.100).aspx">.NET Framework 4</a>
          </li>
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/e8w969hb(d=printer,v=vs.90).aspx">.NET Framework 3.5</a>
          </li>
          <li class="archived">
            <a href="http://msdn.microsoft.com/zh-cn/library/e8w969hb(d=printer,v=vs.80).aspx">.NET Framework 2.0</a>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<div class="introduction"><p>
      <span id="mt1" class="sentence" data-guid="034d41a0ba9d85149df0610bb3f7ee2b" data-source="Platform invoke copies string parameters, converting them from the .NET Framework format (Unicode) to the unmanaged format (ANSI), if needed." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">平台调用复制字符串参数，并在必要时将其从 .NET Framework 格式 (Unicode) 转换为非托管格式 (ANSI)。</sentencetext></span>  <span id="mt2" class="sentence" data-guid="fe1c87356359744fb6be815e555da6fc" data-source="Because managed strings are immutable, platform invoke does not copy them back from unmanaged memory to managed memory when the function returns." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">由于托管字符串是不可变的，因此当函数返回时，平台调用不会将它们从非托管内存复制回托管内存。</sentencetext></span>  </p><p>
      <span id="mt3" class="sentence" data-guid="1631d9989bde70db5358af9fa092efae" data-source="The following table lists marshaling options for strings, describes their usage, and provides a link to the corresponding .NET Framework sample." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">下表列出了字符串的封送处理选项，描述了它们的用法，并提供了到相应的 .NET Framework 示例的链接。</sentencetext></span>
    </p><table responsive="true"><tbody><tr responsive="true"><th><p>
              <span id="mt4" class="sentence" data-guid="b45cffe084dd3d20d928bee85e7b0f21" data-source="String" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">String</sentencetext></span>
            </p></th><th><p>
              <span id="mt5" class="sentence" data-guid="67daf92c833c41c95db874e18fcb2786" data-source="Description" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">说明</sentencetext></span>
            </p></th><th><p>
              <span id="mt6" class="sentence" data-guid="5e8ff9bf55ba3508199d22e984129be6" data-source="Sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">示例</sentencetext></span>
            </p></th></tr><tr><td data-th="
              String
            "><p>
              <span id="mt7" class="sentence" data-guid="c9404ccc37a575608f1d13cd8f3933e2" data-source="By value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过值传递。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt8" class="sentence" data-guid="fa6a7314417769e24ddac9dfd7978497" data-source="Passes strings as In parameters." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将字符串作为 In 参数传递。</sentencetext></span>
            </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/883be1k5(v=vs.110).aspx">MsgBox</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt10" class="sentence" data-guid="1adb0fc75e57492bf3f884b8450c28b6" data-source="As result." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">作为结果。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt11" class="sentence" data-guid="385b655d819c19c17e30fcb6f794f1c1" data-source="Returns strings from unmanaged code." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从非托管代码返回字符串。</sentencetext></span>
            </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/e765dyyy(v=vs.110).aspx">字符串</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt13" class="sentence" data-guid="e72586c1ea5bd686cc384bda2bebca45" data-source="By reference." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过引用传递。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt14" class="sentence" data-guid="f448611d939061e94f747ec19ad2c4a8" data-source="Passes strings as In/Out parameters using &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;StringBuilder&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.text.stringbuilder(v=vs.110).aspx">StringBuilder</a> 将字符串作为 In/Out 参数传递。</sentencetext></span>
            </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/x3txb6xc(v=vs.110).aspx">Buffers</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt16" class="sentence" data-guid="2c758130656a635d90a7b448ff0dc045" data-source="In a structure by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在结构中通过值传递。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt17" class="sentence" data-guid="9dcd2b1fe19398e9b2b407105fbf400c" data-source="Passes strings in a structure that is an In parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在作为 In 参数的结构中传递字符串。</sentencetext></span>
            </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/eadtsekz(v=vs.110).aspx">结构</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt19" class="sentence" data-guid="cff70813bfa797a60d9300fad08b34bd" data-source="In a structure by reference &lt;strong&gt;(char*)&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在结构中通过引用传递 <strong xmlns="http://www.w3.org/1999/xhtml">(char*)</strong>。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt20" class="sentence" data-guid="5b4dec3a4290015e0afb4936652b5eaf" data-source="Passes strings in a structure that is an In/Out parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在作为 In/Out 参数的结构中传递字符串。</sentencetext></span>  <span id="mt21" class="sentence" data-guid="dabe4919e663f10bef7683e390679492" data-source="The unmanaged function expects a pointer to a character buffer and the buffer size is a member of the structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">非托管函数需要指向字符缓冲区的指针，并且缓冲区大小是结构的成员。</sentencetext></span>  </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/e765dyyy(v=vs.110).aspx">字符串</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt23" class="sentence" data-guid="539e16e1e1fc0e1a86920739d4225188" data-source="In a structure by reference &lt;strong&gt;(char[])&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在结构中通过引用传递 <strong xmlns="http://www.w3.org/1999/xhtml">(char[])</strong>。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt24" class="sentence" data-guid="5b4dec3a4290015e0afb4936652b5eaf" data-source="Passes strings in a structure that is an In/Out parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在作为 In/Out 参数的结构中传递字符串。</sentencetext></span>  <span id="mt25" class="sentence" data-guid="5b7051a18c173088113711a47587a60b" data-source="The unmanaged function expects an embedded character buffer." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">非托管函数需要嵌入的字符缓冲区。</sentencetext></span>  </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/795sy883(v=vs.110).aspx">OSInfo</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt27" class="sentence" data-guid="2b0eb253bd33bb765930feb7d4cbaa1e" data-source="In a class by value &lt;strong&gt;(char*)&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在类中通过值传递 <strong xmlns="http://www.w3.org/1999/xhtml">(char*)</strong>。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt28" class="sentence" data-guid="48bd4e08c94ff859fc84e4ac565b9401" data-source="Passes strings in a class (a class is an In/Out parameter)." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在作为 In/Out 参数的类中传递字符串。</sentencetext></span>  <span id="mt29" class="sentence" data-guid="843a550355684debffeee0962dbaefee" data-source="The unmanaged function expects a pointer to a character buffer." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">非托管函数需要指向字符缓冲区的指针。</sentencetext></span>  </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/w5tyztk9(v=vs.110).aspx">OpenFileDlg</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt31" class="sentence" data-guid="a4feab4be340a71ee1356854d745e30f" data-source="In a class by value &lt;strong&gt;(char[])&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在类中通过值传递 <strong xmlns="http://www.w3.org/1999/xhtml">(char[])</strong>。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt32" class="sentence" data-guid="48bd4e08c94ff859fc84e4ac565b9401" data-source="Passes strings in a class (a class is an In/Out parameter)." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在作为 In/Out 参数的类中传递字符串。</sentencetext></span>  <span id="mt33" class="sentence" data-guid="5b7051a18c173088113711a47587a60b" data-source="The unmanaged function expects an embedded character buffer." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">非托管函数需要嵌入的字符缓冲区。</sentencetext></span>  </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/795sy883(v=vs.110).aspx">OSInfo</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt35" class="sentence" data-guid="ed0736478415d1e7aa8564a69a91624d" data-source="As an array of strings by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">作为通过值传递的字符串数组。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt36" class="sentence" data-guid="12abca410b38592687270f768fb3c466" data-source="Creates an array of strings that is passed by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">创建通过值传递的字符串数组。</sentencetext></span>
            </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/hk9wyw21(v=vs.110).aspx">数组</a>
            </p></td></tr><tr><td data-th="
              String
            "><p>
              <span id="mt38" class="sentence" data-guid="af4ac83a9fa7d330656074bdf01c15ad" data-source="As an array of structures that contain strings by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">作为包含通过值传递的字符串的结构数组。</sentencetext></span>
            </p></td><td data-th="
              说明
            "><p>
              <span id="mt39" class="sentence" data-guid="62f447d4058bc1c8dbfeb27282667411" data-source="Creates an array of structures that contain strings and the array is passed by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">创建包含字符串的结构数组，并且该数组是通过值传递的。</sentencetext></span>
            </p></td><td data-th="
              示例
            "><p>
              <a href="https://msdn.microsoft.com/zh-cn/library/hk9wyw21(v=vs.110).aspx">数组</a>
            </p></td></tr></tbody></table></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">请参阅</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/e8w969hb(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><p><a href="https://msdn.microsoft.com/zh-cn/library/fzhhdwae(v=vs.110).aspx">用平台调用封送数据</a><br><a href="https://msdn.microsoft.com/zh-cn/library/ac7ay120(v=vs.110).aspx">Platform Invoke Data Types</a><br><a href="https://msdn.microsoft.com/zh-cn/library/eshywdt7(v=vs.110).aspx">封送类、结构和联合</a><br><a href="https://msdn.microsoft.com/zh-cn/library/dd93y453(v=vs.110).aspx">Marshaling Arrays of Types</a><br><a href="https://msdn.microsoft.com/zh-cn/library/ss9sb93t(v=vs.110).aspx">Miscellaneous Marshaling Samples</a><br></p></div></div></div>
    </div>
  </div>
</div>
  

    </div>



        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="lVlMgrB07bSQ3Qv-AHSLszcAsMFnZ87ujJIBX-McrvKbl62sWpbi9XKb3VCTwmrLN_LiIWl38wSE-XLhACcMLEgEj4E1">
<input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/rate/e8w969hb(d=printer,v=vs.110).aspx">
<input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/additional/e8w969hb(d=printer,v=vs.110).aspx">
<input id="isTopicRated" type="hidden" value="false">




    <div id="lib-footer">
        

    
    <link type="text/css" rel="stylesheet">
    
    <div id="ux-footer" class="" style="" dir="ltr">


    <div id="standardRatingBefore" class="clear stdr-container-before"></div>
    <div id="standardRating" class="stdr-container" ms.pgarea="body">
        <div class="stdr-close"></div>
        <div class="stdr-vote stdr-content">
            <div class="stdr-content">
                <span class="stdr-votetitle">此页面有帮助吗？</span>
                <button class="stdr-yes" aria-label="是，此页面很有帮助">是</button>
                <button class="stdr-no" aria-label="不，此页面没有任何帮助">否</button>
                <input id="s_ratingValue" type="hidden" value="">
            </div>
        </div>
        <div class="stdr-feedback" style="display: none">
            <div class="stdr-form">
                <div class="stdr-fieldtitle">更多反馈？</div>
                <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea>
                <div>
                    <span class="stdr-count"><span class="stdr-charcnt">1500</span> 个剩余字符</span>
                    <div class="stdr-buttons">
                        <button class="stdr-provide" aria-label="提交我的其他反馈">提交</button>
                        <button class="stdr-skip" aria-label="跳过其他反馈">跳过此步</button>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div class="stdr-thanks" style="display: none">
            <div class="stdr-content">
                <span class="stdr-thankyou">谢谢！</span>
                <span class="stdr-appreciate">我们非常感谢您的反馈。</span>
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
    <div id="standardRatingPlaceholder" style="display: none"></div>
    

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">开发人员中心</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/zh-cn/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">更多...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">学习资源</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft 虚拟学院</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">第 9 频道</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN 杂志</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">社区</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/zh-cn/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">论坛</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">博客</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">支持</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">自助支持</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">计划</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark（针对新创企业）</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">创新杯</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/zh-cn/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2fe8w969hb(d%3dprinter%2cv%3dvs.110).aspx%3flan%3dCSharp%26cc%3dn%26trm%3dtra%26view%3dbook">
        <a href="http://msdn.microsoft.com/#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="更改您的语言">中国 (简体中文)</a>
    </form>


            </span>

            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">新闻稿</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">隐私&amp; Cookie</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">使用条款</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">商标</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2016 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>


        <div class="footerPrintView">
            <div class="footerCopyrightPrintView">© 2016 Microsoft</div>
        </div>

        
        

        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17">



        <input id="MtpsDevice" type="hidden" value="Printer">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

        
        
        
            
        






<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="https://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>








<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="naXORQeYP7Ct6qVAvn-qc8coYZ1Q9_1IfZXWAwzF7ol6WLaBJmUBT5TnE26yCTIa34uDUHdqr1WEW22j9Su87wNPQIo1">
</div>


    </div>

    
    

    

    
    
    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/zh-cn/library/e8w969hb(d=printer,l=zh-cn,v=vs.110).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027zh-cn\u0027;\n  var wtsp = \u0027msdnlib_dotnet\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:StandardRating,2:Footer,0:Topic,4:PabTopic,5:webtrendsscript,0:AppInsightsPerf,0:ABTestControl,6:WEDCS,4:CmpgrpForHeader,0:livefyre,0:Comment,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Global/Content:3,/Areas/Library/Content:4,/Areas/Global/Content/Webtrends/resources:5,/Areas/Library/Themes/Base/Content:6\u0026amp;hashKey=BA9931020C89561F32DF1A9F4D3D9490\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026pgArea=header\u0026brand=Msdn\u0026loc=zh-cn\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=搜索 MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:JumpRedirect,1:PrintExportButton;/Areas/Epx/Themes/Base/Content:0,/Areas/Library/Themes/Base/Content:1\u0026amp;hashKey=7006119E9942EFE11F58E00EDB773584\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Toc_Fixed,0:CodeSnippet,0:TopicNotInScope,0:CollapsibleArea,0:VersionSelector,0:SurveyBroker;/Areas/Epx/Content/Scripts:0\u0026amp;hashKey=928842C6187B6959419CA6E8B32D31AC\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>
<link rel="stylesheet" type="text/css" href="./我的集合_files/Combined.css">
    <div id="page">

        

        
    

    
    <link type="text/css" rel="stylesheet">
    
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn">
        

      <header>
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/zh-cn" title="MSDN home">
                  <div id="msft-logo" class="msft-logo"></div>
                </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/zh-cn">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <div class="profileImage"></div>



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=12&ct=1464504564&rver=6.0.5276.0&wp=mcmbi&wlcxt=msdn%24msdn%24msdn&wreply=https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2f883be1k5%2528d%3dprinter%2cv%3dvs.110%2529.aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook&lc=2052&id=254354&mkt=zh-cn">登录</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">MSDN 订阅</span>
  </a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x804&slcid=0x804&campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">获取工具</span>
  </a>
</div>
                  </div>                    
                        <div>
                            <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.weibo.com/cnmsdn" id="SocialLinks_2152_8" class="weiboShare" xmlns="http://www.w3.org/1999/xhtml">http://www.weibo.com/cnmsdn</a>
      </li>
      <li>
        <a href="http://aka.ms/msdnwechat" id="SocialLinks_2152_9" class="wechatShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/msdnwechat</a>
      </li>
      <li>
        <a href="http://aka.ms/contactmsdn" id="SocialLinks_2152_10" class="cnContactShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/contactmsdn</a>
      </li>
    </ul>
  </div>
</div>
                        </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">技术</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="云">云</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="应用开发">应用开发</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="数据">数据</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="游戏">游戏</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/internetofthings" title="物联网">物联网</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">下载</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions/" title="MSDN 订阅访问">MSDN 订阅访问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDK">SDK</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="试用软件">试用软件</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="免费下载">免费下载</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office 资源">Office 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 资源">SharePoint Server 2013 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express 资源">SQL Server 2014 Express 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 资源">Windows Server 2012 资源</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">计划</a>
                                <ul class="navL2">
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN 订阅">MSDN 订阅</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="权益">权益</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="学生">学生</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft 学生合作伙伴">Microsoft 学生合作伙伴</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="架构师">架构师</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="案例研究">案例研究</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="蓝图">蓝图</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="博客">博客</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="论坛">论坛</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/applicationbuilder" title="ISV">ISV</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="新手">新手</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="TechRewards">TechRewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/zh-cn" title="Events（事件）">Events（事件）</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">社区</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="论坛">论坛</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://blogs.msdn.microsoft.com/" title="博客">博客</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/zh-cn" title="技术顾问">技术顾问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="第 9 频道">第 9 频道</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)">文档</a>
                                <ul class="navL2">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="API 和参考">API 和参考</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="开发人员中心">开发人员中心</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/">示例</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)">
      </div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    </div>

    
    
    
    <div id="jumpInfo" style="display: none">非常抱歉。你请求的内容已被删除。将在 1 秒内自动重定向。</div>


    
    <div class="printExportMenus ltr">
        <a id="isd_printABook" href="http://msdn.microsoft.com/zh-cn/library/export/help/(d=printer)?returnurl=%2fzh-cn%2flibrary%2f883be1k5(d%3dprinter,v%3dvs.110).aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook">
            导出 (<span class="count">0</span>)
        </a>
        <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/883be1k5(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book" rel="nofollow">
            打印
        </a>
        <a id="isd_archiveControl" style="display:none;" data-include-archive="显示已存档版本" data-exclude-archive="隐藏已存档版本">
        </a>
    </div>
    
    <div class="printExportMenus ltr">
        <a id="expandCollapseAll" accesskey="e" href="javascript:void(0)" title="Expand/Collapse all sections by pressing Ctrl + Shift + e">全部展开</a>
    </div>

    


        <div id="body" ms.pgarea="body">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="content" class="content">



<input type="hidden" id="printForPab" value="true">



        
<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">MsgBox 示例</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong>
                .NET Framework (current version)
            </strong>
      </div>
      <div id="versionclick">
        <div id="vsseperator" class="cl_lw_vs_seperator"></div>
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        其他版本
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./我的集合_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel">
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/883be1k5(d=printer,v=vs.100).aspx">.NET Framework 4</a>
          </li>
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/883be1k5(d=printer,v=vs.90).aspx">.NET Framework 3.5</a>
          </li>
          <li class="archived">
            <a href="http://msdn.microsoft.com/zh-cn/library/883be1k5(d=printer,v=vs.80).aspx">.NET Framework 2.0</a>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<div class="introduction"><p>
      <span id="mt1" class="sentence" data-guid="6c685cc65bca1cd0dad0ae773a864d4f" data-source="This sample demonstrates how to pass string types by value as In parameters and when to use the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;EntryPoint&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;CharSet&lt;/span&gt;&lt;/span&gt;, and &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;ExactSpelling&lt;/span&gt;&lt;/span&gt; fields. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例演示如何通过值将字符串类型作为 In 参数传递以及何时使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.dllimportattribute.entrypoint(v=vs.110).aspx">EntryPoint</a>、<a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.dllimportattribute.charset(v=vs.110).aspx">CharSet</a> 和 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.dllimportattribute.exactspelling(v=vs.110).aspx">ExactSpelling</a> 字段。</sentencetext></span>
    </p><p>
      <span id="mt2" class="sentence" data-guid="1be4b586fd0d6249891df15867279bb0" data-source="The MsgBox sample uses the following unmanaged function, shown with its original function declaration:  " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">MsgBox 示例使用以下非托管函数（这里同时显示其原始函数声明）：</sentencetext></span>
    </p><ul class="unordered"><li><p>
          <span id="mt3" class="sentence" data-guid="a1e1098f06a505cc4176b8afae4090ca" data-source="&lt;strong&gt;MessageBox&lt;/strong&gt; exported from User32.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 User32.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">MessageBox</strong>。</sentencetext></span>
        </p>
    <div id="code-snippet-1" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int MessageBox(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, 
   UINT uType);
</pre></div>
            </div>
        </div>
    </div>
</li></ul><p>
      <span id="mt4" class="sentence" data-guid="86b47201d343ba705a8b6d75bf36de70" data-source="In this sample, the &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains a managed prototype for each unmanaged function called by the &lt;span class=&quot;code&quot;&gt;MsgBoxSample&lt;/span&gt; class." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在该示例中，<span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MsgBoxSample</span> 类调用的每一个非托管函数的托管原型。</sentencetext></span>  <span id="mt5" class="sentence" data-guid="12ec2f807156b7bcd726750eecec8db7" data-source="The managed prototype methods &lt;span class=&quot;code&quot;&gt;MsgBox&lt;/span&gt;, &lt;span class=&quot;code&quot;&gt;MsgBox2&lt;/span&gt;, and &lt;span class=&quot;code&quot;&gt;MsgBox3&lt;/span&gt; have different declarations for the same unmanaged function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">托管原型方法 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MsgBox</span>、<span class="code" xmlns="http://www.w3.org/1999/xhtml">MsgBox2</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MsgBox3</span> 对于同一个非托管函数具有不同的声明。</sentencetext></span>  </p><p>
      <span id="mt6" class="sentence" data-guid="2dddeabb73c734057a25f3725d26e02e" data-source="The declaration for &lt;span class=&quot;code&quot;&gt;MsgBox2&lt;/span&gt; produces incorrect output in the message box because the character type, specified as ANSI, is mismatched with the entry point &lt;span class=&quot;code&quot;&gt;MessageBoxW&lt;/span&gt;, which is the name of the Unicode function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MsgBox2</span> 的声明将在消息框中产生不正确的输出，原因是被指定为 ANSI 的字符类型与按 Unicode 函数命名的入口点 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MessageBoxW</span> 不匹配。</sentencetext></span>  <span id="mt7" class="sentence" data-guid="6867ba414a81ade27c749a721632007b" data-source="The declaration for &lt;span class=&quot;code&quot;&gt;MsgBox3&lt;/span&gt; creates a mismatch between the &lt;strong&gt;EntryPoint&lt;/strong&gt;, &lt;strong&gt;CharSet&lt;/strong&gt;, and &lt;strong&gt;ExactSpelling&lt;/strong&gt; fields." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MsgBox3</span> 的声明将在 <strong xmlns="http://www.w3.org/1999/xhtml">EntryPoint</strong>、<strong xmlns="http://www.w3.org/1999/xhtml">CharSet</strong> 和 <strong xmlns="http://www.w3.org/1999/xhtml">ExactSpelling</strong> 字段之间产生不匹配现象。</sentencetext></span>  <span id="mt8" class="sentence" data-guid="b026ef8f748f041a5a4bb45da02e0113" data-source="When called, &lt;span class=&quot;code&quot;&gt;MsgBox3&lt;/span&gt; throws an exception." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在调用时，<span class="code" xmlns="http://www.w3.org/1999/xhtml">MsgBox3</span> 将引发异常。</sentencetext></span>  <span id="mt9" class="sentence" data-guid="a130adbb7bc4466c85beaf314862b499" data-source="For detailed information on string naming and name marshaling, see &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Specifying a Character Set&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">有关字符串命名和名称封送处理的详细信息，请参见<a href="https://msdn.microsoft.com/zh-cn/library/7b93s42f(v=vs.110).aspx">指定字符集</a>。</sentencetext></span>  </p></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">声明原型</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/883be1k5(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section">
    <div id="code-snippet-2" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> LibWrap
{
    <span style="color:Green;">// Declares managed prototypes for unmanaged functions.</span>
    [DllImport( <span style="color:#A31515;">"User32.dll"</span>, EntryPoint=<span style="color:#A31515;">"MessageBox"</span>,
        CharSet=CharSet.Auto)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> MsgBox(<span style="color:Blue;">int</span> hWnd, <span style="color:Blue;">string</span> text, <span style="color:Blue;">string</span> caption,
      <span style="color:Blue;">uint</span> type);

    <span style="color:Green;">// Causes incorrect output in the message window.</span>
    [DllImport( <span style="color:#A31515;">"User32.dll"</span>, EntryPoint=<span style="color:#A31515;">"MessageBoxW"</span>,
        CharSet=CharSet.Ansi )]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> MsgBox2(<span style="color:Blue;">int</span> hWnd, <span style="color:Blue;">string</span> text,
       <span style="color:Blue;">string</span> caption, <span style="color:Blue;">uint</span> type);

    <span style="color:Green;">// Causes an exception to be thrown. EntryPoint, CharSet, and</span>
    <span style="color:Green;">// ExactSpelling fields are mismatched.</span>
    [DllImport( <span style="color:#A31515;">"User32.dll"</span>, EntryPoint=<span style="color:#A31515;">"MessageBox"</span>,
        CharSet=CharSet.Ansi, ExactSpelling=<span style="color:Blue;">true</span> )]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> MsgBox3(<span style="color:Blue;">int</span> hWnd, <span style="color:Blue;">string</span> text,
        <span style="color:Blue;">string</span> caption, <span style="color:Blue;">uint</span> type);
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">调用函数</span></a><div id="Anchor_1" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/883be1k5(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_1" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section">
    <div id="code-snippet-3" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> MsgBoxSample
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
    {
        LibWrap.MsgBox(0, <span style="color:#A31515;">"Correct text"</span>, <span style="color:#A31515;">"MsgBox Sample"</span>, 0);
        LibWrap.MsgBox2(0, <span style="color:#A31515;">"Incorrect text"</span>, <span style="color:#A31515;">"MsgBox Sample"</span>, 0);

        <span style="color:Blue;">try</span>
        {
            LibWrap.MsgBox3(0, <span style="color:#A31515;">"No such function"</span>, <span style="color:#A31515;">"MsgBox Sample"</span>, 0);
        }
        <span style="color:Blue;">catch</span>(EntryPointNotFoundException)
        {
           Console.WriteLine(<span style="color:#A31515;">"EntryPointNotFoundException thrown as expected!"</span>);
        }
    }
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">请参阅</span></a><div id="Anchor_2" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/883be1k5(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_2" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><p><a href="https://msdn.microsoft.com/zh-cn/library/e8w969hb(v=vs.110).aspx">封送处理字符串</a><br><a href="https://msdn.microsoft.com/zh-cn/library/ac7ay120(v=vs.110).aspx">Platform Invoke Data Types</a><br><a href="https://msdn.microsoft.com/zh-cn/library/s9ts558h(v=vs.110).aspx">字符串的默认封送处理</a><br><a href="https://msdn.microsoft.com/zh-cn/library/w4byd5y4(v=vs.110).aspx">在托管代码中创建原型</a><br><a href="https://msdn.microsoft.com/zh-cn/library/7b93s42f(v=vs.110).aspx">指定字符集</a><br></p></div></div></div>
    </div>
  </div>
</div>
  

    </div>



        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="Egq-yOwBSclctRtjv5KPeWL3x38fF5z0dtvkTcC_iLzrFLKNKdEfP8QwTSHu4HDpDCYrzOW1LDtOFeo7JYtxOkcg9iY1">
<input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/rate/883be1k5(d=printer,v=vs.110).aspx">
<input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/additional/883be1k5(d=printer,v=vs.110).aspx">
<input id="isTopicRated" type="hidden" value="false">




    <div id="lib-footer">
        

    
    <link type="text/css" rel="stylesheet">
    
    <div id="ux-footer" class="" style="" dir="ltr">


    <div id="standardRatingBefore" class="clear stdr-container-before"></div>
    <div id="standardRating" class="stdr-container" ms.pgarea="body">
        <div class="stdr-close"></div>
        <div class="stdr-vote stdr-content">
            <div class="stdr-content">
                <span class="stdr-votetitle">此页面有帮助吗？</span>
                <button class="stdr-yes" aria-label="是，此页面很有帮助">是</button>
                <button class="stdr-no" aria-label="不，此页面没有任何帮助">否</button>
                <input id="s_ratingValue" type="hidden" value="">
            </div>
        </div>
        <div class="stdr-feedback" style="display: none">
            <div class="stdr-form">
                <div class="stdr-fieldtitle">更多反馈？</div>
                <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea>
                <div>
                    <span class="stdr-count"><span class="stdr-charcnt">1500</span> 个剩余字符</span>
                    <div class="stdr-buttons">
                        <button class="stdr-provide" aria-label="提交我的其他反馈">提交</button>
                        <button class="stdr-skip" aria-label="跳过其他反馈">跳过此步</button>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div class="stdr-thanks" style="display: none">
            <div class="stdr-content">
                <span class="stdr-thankyou">谢谢！</span>
                <span class="stdr-appreciate">我们非常感谢您的反馈。</span>
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
    <div id="standardRatingPlaceholder" style="display: none"></div>
    

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">开发人员中心</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/zh-cn/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">更多...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">学习资源</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft 虚拟学院</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">第 9 频道</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN 杂志</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">社区</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/zh-cn/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">论坛</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">博客</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">支持</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">自助支持</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">计划</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark（针对新创企业）</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">创新杯</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/zh-cn/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2f883be1k5(d%3dprinter%2cv%3dvs.110).aspx%3flan%3dCSharp%26cc%3dn%26trm%3dtra%26view%3dbook">
        <a href="http://msdn.microsoft.com/#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="更改您的语言">中国 (简体中文)</a>
    </form>


            </span>

            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">新闻稿</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">隐私&amp; Cookie</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">使用条款</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">商标</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2016 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>


        <div class="footerPrintView">
            <div class="footerCopyrightPrintView">© 2016 Microsoft</div>
        </div>

        
        

        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17">



        <input id="MtpsDevice" type="hidden" value="Printer">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

        
        
        
            
        






<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="https://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>








<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="Ngwr863SipmKYM7o_iYOWIWf9irQmZjqRSvhYtS1zw7vo5Slx4yAyL2fOI_juZN7yI4Dq0PIbCLBkqCOI0w3zlVCz9M1">
</div>


    </div>

    
    

    

    
    
    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/zh-cn/library/883be1k5(d=printer,l=zh-cn,v=vs.110).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027zh-cn\u0027;\n  var wtsp = \u0027msdnlib_dotnet\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:StandardRating,2:Footer,0:Topic,4:PabTopic,5:webtrendsscript,0:AppInsightsPerf,0:ABTestControl,6:WEDCS,4:CmpgrpForHeader,0:livefyre,0:Comment,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Global/Content:3,/Areas/Library/Content:4,/Areas/Global/Content/Webtrends/resources:5,/Areas/Library/Themes/Base/Content:6\u0026amp;hashKey=BA9931020C89561F32DF1A9F4D3D9490\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026pgArea=header\u0026brand=Msdn\u0026loc=zh-cn\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=搜索 MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:JumpRedirect,1:PrintExportButton;/Areas/Epx/Themes/Base/Content:0,/Areas/Library/Themes/Base/Content:1\u0026amp;hashKey=7006119E9942EFE11F58E00EDB773584\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Toc_Fixed,0:CodeSnippet,0:TopicNotInScope,0:CollapsibleArea,0:VersionSelector,0:SurveyBroker;/Areas/Epx/Content/Scripts:0\u0026amp;hashKey=928842C6187B6959419CA6E8B32D31AC\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>
<link rel="stylesheet" type="text/css" href="./我的集合_files/Combined.css">
    <div id="page">

        

        
    

    
    <link type="text/css" rel="stylesheet">
    
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn">
        

      <header>
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/zh-cn" title="MSDN home">
                  <div id="msft-logo" class="msft-logo"></div>
                </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/zh-cn">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <div class="profileImage"></div>



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=12&ct=1464504566&rver=6.0.5276.0&wp=mcmbi&wlcxt=msdn%24msdn%24msdn&wreply=https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2feshywdt7%2528d%3dprinter%2cv%3dvs.110%2529.aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook&lc=2052&id=254354&mkt=zh-cn">登录</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">MSDN 订阅</span>
  </a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x804&slcid=0x804&campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">获取工具</span>
  </a>
</div>
                  </div>                    
                        <div>
                            <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.weibo.com/cnmsdn" id="SocialLinks_2152_8" class="weiboShare" xmlns="http://www.w3.org/1999/xhtml">http://www.weibo.com/cnmsdn</a>
      </li>
      <li>
        <a href="http://aka.ms/msdnwechat" id="SocialLinks_2152_9" class="wechatShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/msdnwechat</a>
      </li>
      <li>
        <a href="http://aka.ms/contactmsdn" id="SocialLinks_2152_10" class="cnContactShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/contactmsdn</a>
      </li>
    </ul>
  </div>
</div>
                        </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">技术</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="云">云</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="应用开发">应用开发</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="数据">数据</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="游戏">游戏</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/internetofthings" title="物联网">物联网</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">下载</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions/" title="MSDN 订阅访问">MSDN 订阅访问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDK">SDK</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="试用软件">试用软件</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="免费下载">免费下载</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office 资源">Office 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 资源">SharePoint Server 2013 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express 资源">SQL Server 2014 Express 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 资源">Windows Server 2012 资源</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">计划</a>
                                <ul class="navL2">
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN 订阅">MSDN 订阅</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="权益">权益</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="学生">学生</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft 学生合作伙伴">Microsoft 学生合作伙伴</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="架构师">架构师</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="案例研究">案例研究</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="蓝图">蓝图</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="博客">博客</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="论坛">论坛</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/applicationbuilder" title="ISV">ISV</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="新手">新手</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="TechRewards">TechRewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/zh-cn" title="Events（事件）">Events（事件）</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">社区</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="论坛">论坛</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://blogs.msdn.microsoft.com/" title="博客">博客</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/zh-cn" title="技术顾问">技术顾问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="第 9 频道">第 9 频道</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)">文档</a>
                                <ul class="navL2">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="API 和参考">API 和参考</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="开发人员中心">开发人员中心</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/">示例</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)">
      </div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    </div>

    
    
    
    <div id="jumpInfo" style="display: none">非常抱歉。你请求的内容已被删除。将在 1 秒内自动重定向。</div>


    
    <div class="printExportMenus ltr">
        <a id="isd_printABook" href="http://msdn.microsoft.com/zh-cn/library/export/help/(d=printer)?returnurl=%2fzh-cn%2flibrary%2feshywdt7(d%3dprinter,v%3dvs.110).aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook">
            导出 (<span class="count">0</span>)
        </a>
        <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book" rel="nofollow">
            打印
        </a>
        <a id="isd_archiveControl" style="display:none;" data-include-archive="显示已存档版本" data-exclude-archive="隐藏已存档版本">
        </a>
    </div>
    
    <div class="printExportMenus ltr">
        <a id="expandCollapseAll" accesskey="e" href="javascript:void(0)" title="Expand/Collapse all sections by pressing Ctrl + Shift + e">全部展开</a>
    </div>

    


        <div id="body" ms.pgarea="body">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="content" class="content">



<input type="hidden" id="printForPab" value="true">



        
<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">封送类、结构和联合</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong>
                .NET Framework (current version)
            </strong>
      </div>
      <div id="versionclick">
        <div id="vsseperator" class="cl_lw_vs_seperator"></div>
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        其他版本
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./我的集合_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel">
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.100).aspx">.NET Framework 4</a>
          </li>
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.90).aspx">.NET Framework 3.5</a>
          </li>
          <li class="archived">
            <a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.80).aspx">.NET Framework 2.0</a>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<div class="introduction"><p>
        <span id="mt1" class="sentence" data-guid="d3b635fde5906262a0897b8cb47a42cf" data-source="Classes and structures are similar in the .NET Framework." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">.NET Framework 中类和结构非常相似。</sentencetext></span>  <span id="mt2" class="sentence" data-guid="f2fe7f5b0901130e53173faeabc0e660" data-source="Both can have fields, properties, and events." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">它们都可以具有字段、属性和事件。</sentencetext></span>  <span id="mt3" class="sentence" data-guid="613773911bb213a8a75d9585ee8f31da" data-source="They can also have static and nonstatic methods." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">并且都可以具有静态和非静态方法。</sentencetext></span>  <span id="mt4" class="sentence" data-guid="1f86e942d14bbe0a1faae79ae04049ff" data-source="One notable difference is that structures are value types and classes are reference types." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">一个显著区别是结构是值类型，而类是引用类型。</sentencetext></span>  </p><p>
        <span id="mt5" class="sentence" data-guid="833f5e60b065d684afca80742b79a72f" data-source="The following table lists marshaling options for classes, structures, and unions; describes their usage; and provides a link to the corresponding platform invoke sample." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">下表列出了类、结构和联合的封送处理选项；描述了它们的用法；并提供了到相应平台调用示例的链接。</sentencetext></span>
      </p><table responsive="true"><tbody><tr responsive="true"><th><p>
                <span id="mt6" class="sentence" data-guid="599dcce2998a6b40b1e38e8c6006cb0a" data-source="Type" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">类型</sentencetext></span>
              </p></th><th><p>
                <span id="mt7" class="sentence" data-guid="67daf92c833c41c95db874e18fcb2786" data-source="Description" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">描述</sentencetext></span>
              </p></th><th><p>
                <span id="mt8" class="sentence" data-guid="5e8ff9bf55ba3508199d22e984129be6" data-source="Sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">示例</sentencetext></span>
              </p></th></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt9" class="sentence" data-guid="c60a60b503e8bdc6dc7b677687f0cb51" data-source="Class by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">按值显示类。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt10" class="sentence" data-guid="0f41e09f8f4e038074a2a2298eac2a4a" data-source="Passes a class with integer members as an In/Out parameter, like the managed case." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将具有整数成员的类传递为 In/Out 参数，与托管的情形相似。</sentencetext></span>
            </p></td><td data-th="
                示例
              "><p>
              <span id="mt11" class="sentence" data-guid="308882a7a904c58fbaecfd0245045874" data-source="SysTime sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">SysTime 示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt12" class="sentence" data-guid="605f2ea204d3c130893560633a3400a8" data-source="Structure by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">按值显示结构。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt13" class="sentence" data-guid="1ae57559cdf85c0777ab829877ff3575" data-source="Passes structures as In parameters." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将结构作为 In 参数传递。</sentencetext></span>
            </p></td><td data-th="
                示例
              "><p>
              <span id="mt14" class="sentence" data-guid="be76e4e15ec8f2dab881bdd7c638f2e0" data-source="Structures sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">“结构”示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt15" class="sentence" data-guid="b39496d50225b138a54fc1fddca66e73" data-source="Structure by reference." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">按引用显示结构。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt16" class="sentence" data-guid="b47feda9ded5ab524d51dc88cf52c463" data-source="Passes structures as In/Out parameters." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将结构作为 In/Out 参数传递。</sentencetext></span>
            </p></td><td data-th="
                示例
              "><p>
              <span id="mt17" class="sentence" data-guid="32562e99f6ede3583174b395329870a4" data-source="OSInfo sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">OSInfo 示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt18" class="sentence" data-guid="323f1df3c967b19c3d5b2c93f7a9e1ec" data-source="Structure with nested structures (flattened)." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">具有内嵌结构（平展）的结构。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt19" class="sentence" data-guid="3d7d09d4aff0bdebfb2a4ffad2f15446" data-source="Passes a class that represents a structure with nested structures in the unmanaged function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递非托管函数中表示内嵌结构的结构的类。</sentencetext></span>  <span id="mt20" class="sentence" data-guid="4fc23b8c9466f0bb501ff11a09885cf1" data-source="The structure is flattened to one big structure in the managed prototype." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此结构在托管的原型中将平展为一个大的结构。</sentencetext></span>  </p></td><td data-th="
                示例
              "><p>
              <span id="mt21" class="sentence" data-guid="532c4d92d0f719907df6cb051b792fbd" data-source="FindFile sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">FindFile 示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt22" class="sentence" data-guid="a1d5752c36e71ff6f59ba0e62a3e7f77" data-source="Structure with a pointer to another structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">具有指向另一结构的指针的结构。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt23" class="sentence" data-guid="17fd2ef6819745ca8eb1855070c61bcf" data-source="Passes a structure that contains a pointer to a second structure as a member." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将包含指向第二结构的指针的结构作为成员传递。</sentencetext></span>
            </p></td><td data-th="
                示例
              "><p>
              <span id="mt24" class="sentence" data-guid="be76e4e15ec8f2dab881bdd7c638f2e0" data-source="Structures Sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">结构示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt25" class="sentence" data-guid="118433d4e6103afc64f9b9f295569690" data-source="Array of structures with integers by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">按值显示具有整数的结构数组。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt26" class="sentence" data-guid="4b7bcc1ff79f97ad232e302accb7c09e" data-source="Passes an array of structures that contain only integers as an In/Out parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将仅包含整数的结构数组作为 In/Out 参数进行传递。</sentencetext></span>  <span id="mt27" class="sentence" data-guid="53e0fd950e178bbfac652f2d187f5df8" data-source="Members of the array can be changed." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">可以更改数组的成员。</sentencetext></span>  </p></td><td data-th="
                示例
              "><p>
              <span id="mt28" class="sentence" data-guid="dad14e71cbadb8dbce472eadbb873933" data-source="Arrays Sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">“数组”示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt29" class="sentence" data-guid="a4b2d7a48f76cf214430cb7babdd8788" data-source="Array of structures with integers and strings by reference." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">按引用显示具有整数和字符串的结构数组。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt30" class="sentence" data-guid="7f62b362e511150665ef4b54e735ddac" data-source="Passes an array of structures that contain integers and strings as an Out parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将包含整数和字符串的结构数组作为 Out 参数传递。</sentencetext></span>  <span id="mt31" class="sentence" data-guid="f37f310e44481fe17167e06c5ad9a8c5" data-source="The called function allocates memory for the array." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">被调用的函数为数组分配内存。</sentencetext></span>  </p></td><td data-th="
                示例
              "><p>
              <span id="mt32" class="sentence" data-guid="866284659d1f21b492e3aec612a6c70f" data-source="OutArrayOfStructs Sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">OutArrayOfStructs 示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt33" class="sentence" data-guid="fd6f23db0f07b54542b2cbe5d12de9f1" data-source="Unions with value types." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">具有值类型的联合。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt34" class="sentence" data-guid="31c13b147b8463e7c33f4d85c64f84a4" data-source="Passes unions with value types (integer and double)." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递具有值类型（整数和双精度）的联合。</sentencetext></span>
            </p></td><td data-th="
                示例
              "><p>
              <span id="mt35" class="sentence" data-guid="33c21bb60f8bc093bf296a3d581fe981" data-source="Unions sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">“联合”示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt36" class="sentence" data-guid="a8e86a6d5a6bb7ede525801d2bda2b83" data-source="Unions with mixed types." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">具有混合类型的联合。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              <span id="mt37" class="sentence" data-guid="c05145d2b1621ce57d3a5c17cb0a4ee5" data-source="Passes unions with mixed types (integer and string)." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递具有混合类型（整数和字符串）的联合。</sentencetext></span>
            </p></td><td data-th="
                示例
              "><p>
              <span id="mt38" class="sentence" data-guid="33c21bb60f8bc093bf296a3d581fe981" data-source="Unions sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">“联合”示例</sentencetext></span>
            </p></td></tr><tr><td data-th="
                类型
              "><p>
              <span id="mt39" class="sentence" data-guid="aaee3088131319194aa32d7730bed1dc" data-source="Null values in structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">结构中的 null 值。</sentencetext></span>
            </p></td><td data-th="
                描述
              "><p>
              
                <span id="mt40" class="sentence" data-guid="be87575654c432c5489406487601a9cf" data-source="Passes a null reference (&lt;strong&gt;Nothing&lt;/strong&gt; in Visual Basic) instead of a reference to a value type." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递 null 引用（Visual Basic 中为 <strong xmlns="http://www.w3.org/1999/xhtml">Nothing</strong>），而不传递对值类型的引用。</sentencetext></span>
              
            </p></td><td data-th="
                示例
              "><p>
              <span id="mt41" class="sentence" data-guid="50be2649ee959458a35eec630022039a" data-source="HandleRef sample" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">HandleRef 示例</sentencetext></span>
            </p></td></tr></tbody></table></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">结构示例</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p>
          <span id="mt43" class="sentence" data-guid="3a3bb3810827a61f601a177ef4cec032" data-source="This sample demonstrates how to pass a structure that points to a second structure, pass a structure with an embedded structure, and pass a structure with an embedded array." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例演示了如何传递指向第二结构的结构、具有嵌入结构的结构和具有嵌入数组的结构。</sentencetext></span>
        </p><p>
          <span id="mt44" class="sentence" data-guid="f55517ad348eaa2efd3ed75205ab8352" data-source="The Structs sample uses the following unmanaged functions, shown with their original function declaration:  " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">“结构”示例使用以下非托管函数（与原始函数声明一同显示）：  </sentencetext></span>
        </p><ul class="unordered"><li><p>
              
                <span id="mt45" class="sentence" data-guid="b424b9f943ad95a03efe1c15999297d8" data-source="&lt;strong&gt;TestStructInStruct&lt;/strong&gt; exported from PinvokeLib.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestStructInStruct</strong>。</sentencetext></span>
              
            </p>
    <div id="code-snippet-1" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int TestStructInStruct(MYPERSON2* pPerson2);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p>
              
                <span id="mt46" class="sentence" data-guid="4e85d965f7e4c76f76771434cb30480d" data-source="&lt;strong&gt;TestStructInStruct3&lt;/strong&gt; exported from PinvokeLib.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestStructInStruct3</strong>。</sentencetext></span>
              
            </p>
    <div id="code-snippet-2" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>void TestStructInStruct3(MYPERSON3 person3);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p>
              
                <span id="mt47" class="sentence" data-guid="c290a519eca2bf09842daa0d4ad90f86" data-source="&lt;strong&gt;TestArrayInStruct&lt;/strong&gt; exported from PinvokeLib.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestArrayInStruct</strong>。</sentencetext></span>
              
            </p>
    <div id="code-snippet-3" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>void TestArrayInStruct( MYARRAYSTRUCT* pStruct );
</pre></div>
            </div>
        </div>
    </div>
</li></ul><p>
          <span id="mt48" class="sentence" data-guid="924c36b74a7072f4b3e145554a272fbb" data-source="&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;PinvokeLib.dll&lt;/span&gt;&lt;/span&gt; is a custom unmanaged library that contains implementations for the previously listed functions and four structures: &lt;strong&gt;MYPERSON&lt;/strong&gt;, &lt;strong&gt;MYPERSON2&lt;/strong&gt;, &lt;strong&gt;MYPERSON3&lt;/strong&gt;, and &lt;strong&gt;MYARRAYSTRUCT&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/as6wyhwt(v=vs.110).aspx">PinvokeLib.dll</a> 是一种自定义的非托管库，包含上述函数和 4 种结构（<strong xmlns="http://www.w3.org/1999/xhtml">MYPERSON</strong>、<strong xmlns="http://www.w3.org/1999/xhtml">MYPERSON2</strong>、<strong xmlns="http://www.w3.org/1999/xhtml">MYPERSON3</strong> 和 <strong xmlns="http://www.w3.org/1999/xhtml">MYARRAYSTRUCT</strong>）的实现。</sentencetext></span>  <span id="mt49" class="sentence" data-guid="ae19ce42d35b8686d2cb1015b31b52af" data-source="These structures contain the following elements:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">这些结构包含以下元素：</sentencetext></span>  </p>
    <div id="code-snippet-4" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>typedef struct _MYPERSON
{
   char* first; 
   char* last; 
} MYPERSON, *LP_MYPERSON;

typedef struct _MYPERSON2
{
   MYPERSON* person;
   int age; 
} MYPERSON2, *LP_MYPERSON2;

typedef struct _MYPERSON3
{
   MYPERSON person;
   int age; 
} MYPERSON3;

typedef struct _MYARRAYSTRUCT
{
   bool flag;
   int vals[ 3 ]; 
} MYARRAYSTRUCT;
</pre></div>
            </div>
        </div>
    </div>
<p>
          
            <span id="mt50" class="sentence" data-guid="5468c685fa090f02a56f511b7544177e" data-source="The managed &lt;span class=&quot;code&quot;&gt;MyPerson&lt;/span&gt;,&lt;span class=&quot;code&quot;&gt; MyPerson2&lt;/span&gt;, &lt;span class=&quot;code&quot;&gt;MyPerson3&lt;/span&gt;, and &lt;span class=&quot;code&quot;&gt;MyArrayStruct&lt;/span&gt; structures have the following characteristic:  " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">托管的 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson</span>、<span class="code" xmlns="http://www.w3.org/1999/xhtml"> MyPerson2</span>、<span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson3</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyArrayStruct</span> 结构具有以下特征：  </sentencetext></span>
          
        </p><ul class="unordered"><li><p>
              <span id="mt51" class="sentence" data-guid="91facd28e1bd3b0355995f84bea0839c" data-source="&lt;span class=&quot;code&quot;&gt;MyPerson&lt;/span&gt; contains only string members." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson</span> 仅包含字符串成员。</sentencetext></span>  <span id="mt52" class="sentence" data-guid="8a664a13c2b18438089a5780e9e88c8a" data-source="The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;CharSet&lt;/span&gt;&lt;/span&gt; field sets the strings to ANSI format when passed to the unmanaged function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/7b93s42f(v=vs.110).aspx">CharSet</a> 字段在传递到非托管函数时将字符串设置为 ANSI 格式。</sentencetext></span>  </p></li><li><p>
              <span id="mt53" class="sentence" data-guid="2e557ac80ca7ddb56f82a25edd8a87b8" data-source="&lt;span class=&quot;code&quot;&gt;MyPerson2&lt;/span&gt; contains an &lt;strong&gt;IntPtr&lt;/strong&gt; to the &lt;span class=&quot;code&quot;&gt;MyPerson&lt;/span&gt; structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson2</span> 将 <strong xmlns="http://www.w3.org/1999/xhtml">IntPtr</strong> 包含到 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson</span> 结构中。</sentencetext></span>  <span id="mt54" class="sentence" data-guid="d6e56a26c55784792d91bd9923b57e5d" data-source="The &lt;strong&gt;IntPtr&lt;/strong&gt; type replaces the original pointer to the unmanaged structure because .NET Framework applications do not use pointers unless the code is marked &lt;strong&gt;unsafe&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <strong xmlns="http://www.w3.org/1999/xhtml">IntPtr</strong> 类型替换指向非托管结构的原始指针，因为 .NET Framework 应用程序不使用指针，除非代码被标记为<strong xmlns="http://www.w3.org/1999/xhtml">不安全</strong>。</sentencetext></span>  </p></li><li><p>
              <span id="mt55" class="sentence" data-guid="9c201fc159126f4e6e1f6fb64bf66bba" data-source="&lt;span class=&quot;code&quot;&gt;MyPerson3&lt;/span&gt; contains &lt;span class=&quot;code&quot;&gt;MyPerson&lt;/span&gt; as an embedded structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson3</span> 将 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson</span> 作为嵌入结构包含在内。</sentencetext></span>  <span id="mt56" class="sentence" data-guid="72b95264a9e93239717028a806cf272c" data-source="A structure embedded within another structure can be flattened by placing the elements of the embedded structure directly into the main structure, or it can be left as an embedded structure, as is done in this sample." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">嵌入其他结构的结构可通过将嵌入结构的元素直接放入主结构中来进行平展，还可以保留为嵌入结构，如本示例中操作所示。</sentencetext></span>  </p></li><li><p>
              <span id="mt57" class="sentence" data-guid="76cc44f11761909244b3e10e5314e80d" data-source="&lt;span class=&quot;code&quot;&gt;MyArrayStruct&lt;/span&gt; contains an array of integers." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyArrayStruct</span> 包含整数数组。</sentencetext></span>  <span id="mt58" class="sentence" data-guid="c39eaaa489252d6710fa209e0ddbd0e7" data-source="The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;MarshalAsAttribute&lt;/span&gt;&lt;/span&gt; attribute sets the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;UnmanagedType&lt;/span&gt;&lt;/span&gt; enumeration value to &lt;strong&gt;ByValArray&lt;/strong&gt;, which is used to indicate the number of elements in the array." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshalasattribute(v=vs.110).aspx">MarshalAsAttribute</a> 属性将 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.unmanagedtype(v=vs.110).aspx">UnmanagedType</a> 枚举值设置为 <strong xmlns="http://www.w3.org/1999/xhtml">ByValArray</strong>，此值用于指示数组中的元素数。</sentencetext></span>  </p></li></ul><p>
          
            <span id="mt59" class="sentence" data-guid="755c16e1fb309c0b239030bbabc68d62" data-source="For all structures in this sample, the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;StructLayoutAttribute&lt;/span&gt;&lt;/span&gt; attribute is applied to ensure that the members are arranged in memory sequentially, in the order in which they appear." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">对于此示例中的所有结构，应用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.structlayoutattribute(v=vs.110).aspx">StructLayoutAttribute</a> 属性以确保成员在内存中按出现的顺序进行排列。</sentencetext></span>
          
        </p><p>
          <span id="mt60" class="sentence" data-guid="580d40f7d92b3ca0273eef310b42dd22" data-source="The &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains managed prototypes for the &lt;span class=&quot;code&quot;&gt;TestStructInStruct&lt;/span&gt;, &lt;span class=&quot;code&quot;&gt;TestStructInStruct3&lt;/span&gt;, and &lt;span class=&quot;code&quot;&gt;TestArrayInStruct&lt;/span&gt; methods called by the &lt;span class=&quot;code&quot;&gt;App&lt;/span&gt; class." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含 <span class="code" xmlns="http://www.w3.org/1999/xhtml">App</span> 类所调用的 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestStructInStruct</span>、<span class="code" xmlns="http://www.w3.org/1999/xhtml">TestStructInStruct3</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestArrayInStruct</span> 方法的托管原型。</sentencetext></span>  <span id="mt61" class="sentence" data-guid="8f9607d4f1c8296fd9f6a06a754aaaf1" data-source="Each prototype declares a single parameter, as follows:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">每个原型均声明一个参数，如下所示：</sentencetext></span>  </p><ul class="unordered"><li><p>
              
                <span id="mt62" class="sentence" data-guid="b8b62ab27088f734e20629b4ce012f52" data-source="&lt;span class=&quot;code&quot;&gt;TestStructInStruct&lt;/span&gt; declares a reference to type &lt;span class=&quot;code&quot;&gt;MyPerson2&lt;/span&gt; as its parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestStructInStruct</span> 将对 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson2</span> 类型的引用声明为其参数。</sentencetext></span>
              
            </p></li><li><p>
              
                <span id="mt63" class="sentence" data-guid="aa0dabe32029d77f155db985ed06d3e0" data-source="&lt;span class=&quot;code&quot;&gt;TestStructInStruct3&lt;/span&gt; declares type &lt;span class=&quot;code&quot;&gt;MyPerson3&lt;/span&gt; as its parameter and passes the parameter by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestStructInStruct3</span> 将 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson3</span> 类型声明为其参数并按值传递此参数。</sentencetext></span>
              
            </p></li><li><p>
              
                <span id="mt64" class="sentence" data-guid="3a69b9f188344e5fe78ad59fc7d66184" data-source="&lt;span class=&quot;code&quot;&gt;TestArrayInStruct&lt;/span&gt; declares a reference to type &lt;span class=&quot;code&quot;&gt;MyArrayStruct&lt;/span&gt; as its parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestArrayInStruct</span> 将对 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyArrayStruct</span> 类型的引用声明为其参数。</sentencetext></span>
              
            </p></li></ul><p>
          <span id="mt65" class="sentence" data-guid="4ca90aca0e312ab0c46ba033f0bf789a" data-source="Structures as arguments to methods are passed by value unless the parameter contains the &lt;strong&gt;ref&lt;/strong&gt; (&lt;strong&gt;ByRef&lt;/strong&gt; in Visual Basic) keyword." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">作为方法参数的结构按值传递，除非此参数包含 <strong xmlns="http://www.w3.org/1999/xhtml">ref</strong>（Visual Basic 中为 <strong xmlns="http://www.w3.org/1999/xhtml">ByRef</strong>）关键字。</sentencetext></span>  <span id="mt66" class="sentence" data-guid="4b583a4a114a50e1c9cf3ab500a47dba" data-source="For example, the &lt;span class=&quot;code&quot;&gt;TestStructInStruct&lt;/span&gt; method passes a reference (the value of an address) to an object of type &lt;span class=&quot;code&quot;&gt;MyPerson2&lt;/span&gt; to unmanaged code." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">例如，<span class="code" xmlns="http://www.w3.org/1999/xhtml">TestStructInStruct</span> 方法将对 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson2</span> 类型对象的引用（地址的值）传递到非托管代码。</sentencetext></span>  <span id="mt67" class="sentence" data-guid="bf6f960fca36d9372e3aaaa69fac9364" data-source="To manipulate the structure that &lt;span class=&quot;code&quot;&gt;MyPerson2&lt;/span&gt; points to, the sample creates a buffer of a specified size and returns its address by combining the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Marshal&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;AllocCoTaskMem&lt;/span&gt;&lt;/span&gt; and &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Marshal&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;SizeOf&lt;/span&gt;&lt;/span&gt; methods." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">为了处理 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson2</span> 指向的结构，此示例创建了具有指定大小的缓冲区，并同时使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal.alloccotaskmem(v=vs.110).aspx">Marshal<span xmlns="">.</span>AllocCoTaskMem</a> 和 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal.sizeof(v=vs.110).aspx">Marshal<span xmlns="">.</span>SizeOf</a> 方法返回其地址。</sentencetext></span>  <span id="mt68" class="sentence" data-guid="eb34f984228b116cf543aacf20346f9e" data-source="Next, the sample copies the content of the managed structure to the unmanaged buffer." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">然后，此示例将该托管结构的内容复制到非托管的缓冲区。</sentencetext></span>  <span id="mt69" class="sentence" data-guid="7da1429262d9e11d4b1d642913f77150" data-source="Finally, the sample uses the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Marshal&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;PtrToStructure&lt;/span&gt;&lt;/span&gt; method to marshal data from the unmanaged buffer to a managed object and the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Marshal&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;FreeCoTaskMem&lt;/span&gt;&lt;/span&gt; method to free the unmanaged block of memory." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">最后，此示例使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal.ptrtostructure(v=vs.110).aspx">Marshal<span xmlns="">.</span>PtrToStructure</a> 方法将非托管缓冲区的数据封送到托管对象，并使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal.freecotaskmem(v=vs.110).aspx">Marshal<span xmlns="">.</span>FreeCoTaskMem</a> 方法释放非托管的内存块。</sentencetext></span>  </p></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">声明原型</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-5" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Green;">// Declares a managed structure for each unmanaged structure.</span>
[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyPerson
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">string</span> first;
    <span style="color:Blue;">public</span> <span style="color:Blue;">string</span> last;
}

[StructLayout(LayoutKind.Sequential)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyPerson2
{
    <span style="color:Blue;">public</span> IntPtr person;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> age;
}

[StructLayout(LayoutKind.Sequential)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyPerson3
{
    <span style="color:Blue;">public</span> MyPerson person;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> age;
}

[StructLayout(LayoutKind.Sequential)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyArrayStruct
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">bool</span> flag;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst=3)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>[] vals;
}

<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> LibWrap
{
    <span style="color:Green;">// Declares a managed prototype for unmanaged function.</span>
    [DllImport(<span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestStructInStruct(<span style="color:Blue;">ref</span> MyPerson2 person2);

    [DllImport(<span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestStructInStruct3(MyPerson3 person3);

    [DllImport(<span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestArrayInStruct(<span style="color:Blue;">ref</span> MyArrayStruct myStruct);
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">调用函数</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-6" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> App
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
    {
        <span style="color:Green;">// Structure with a pointer to another structure.</span>
        MyPerson personName;
        personName.first = <span style="color:#A31515;">"Mark"</span>;
        personName.last = <span style="color:#A31515;">"Lee"</span>;

        MyPerson2 personAll;
        personAll.age = 30;

        IntPtr buffer = Marshal.AllocCoTaskMem(Marshal.SizeOf(personName));
        Marshal.StructureToPtr(personName, buffer, <span style="color:Blue;">false</span>);

        personAll.person = buffer;

        Console.WriteLine(<span style="color:#A31515;">"\nPerson before call:"</span>);
        Console.WriteLine(<span style="color:#A31515;">"first = {0}, last = {1}, age = {2}"</span>,
            personName.first, personName.last, personAll.age);

        <span style="color:Blue;">int</span> res = LibWrap.TestStructInStruct(<span style="color:Blue;">ref</span> personAll);

        MyPerson personRes =
            (MyPerson)Marshal.PtrToStructure(personAll.person,
            <span style="color:Blue;">typeof</span>(MyPerson));

        Marshal.FreeCoTaskMem(buffer);

        Console.WriteLine(<span style="color:#A31515;">"Person after call:"</span>);
        Console.WriteLine(<span style="color:#A31515;">"first = {0}, last = {1}, age = {2}"</span>,
            personRes.first, personRes.last, personAll.age);

        <span style="color:Green;">// Structure with an embedded structure.</span>
        MyPerson3 person3 = <span style="color:Blue;">new</span> MyPerson3();
        person3.person.first = <span style="color:#A31515;">"John"</span>;
        person3.person.last = <span style="color:#A31515;">"Evans"</span>;
        person3.age = 27;
        LibWrap.TestStructInStruct3(person3);

        <span style="color:Green;">// Structure with an embedded array.</span>
        MyArrayStruct myStruct = <span style="color:Blue;">new</span> MyArrayStruct();

        myStruct.flag = <span style="color:Blue;">false</span>;
        myStruct.vals = <span style="color:Blue;">new</span> <span style="color:Blue;">int</span>[3];
        myStruct.vals[0] = 1;
        myStruct.vals[1] = 4;
        myStruct.vals[2] = 9;

        Console.WriteLine(<span style="color:#A31515;">"\nStructure with array before call:"</span>);
        Console.WriteLine(myStruct.flag);
        Console.WriteLine(<span style="color:#A31515;">"{0} {1} {2}"</span>, myStruct.vals[0],
            myStruct.vals[1], myStruct.vals[2]);

        LibWrap.TestArrayInStruct(<span style="color:Blue;">ref</span> myStruct);
        Console.WriteLine(<span style="color:#A31515;">"\nStructure with array after call:"</span>);
        Console.WriteLine(myStruct.flag);
        Console.WriteLine(<span style="color:#A31515;">"{0} {1} {2}"</span>, myStruct.vals[0],
            myStruct.vals[1], myStruct.vals[2]);
    }
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">FindFile 示例</span></a><div id="Anchor_1" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_1" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p>
          <span id="mt75" class="sentence" data-guid="f1d6d418d2b74874a3eaddecdd223d53" data-source="This sample demonstrates how to pass a structure that contains a second, embedded structure to an unmanaged function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例演示了如何将包含第二、嵌入结构的结构传递到非托管函数。</sentencetext></span>  <span id="mt76" class="sentence" data-guid="0f9192b6e5c89bbcdfbb82a6584afe30" data-source="It also demonstrates how to use the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;MarshalAsAttribute&lt;/span&gt;&lt;/span&gt; attribute to declare a fixed-length array within the structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">它还演示了如何使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshalasattribute(v=vs.110).aspx">MarshalAsAttribute</a> 属性在结构中声明固定长度的数组。</sentencetext></span>  <span id="mt77" class="sentence" data-guid="ae7771f310288b4889eb6795cb53a7b3" data-source="In this sample, the embedded structure elements are added to the parent structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在此示例中，嵌入的结构元素将添加到父结构。</sentencetext></span>  <span id="mt78" class="sentence" data-guid="db8de24fe52b1e03e393ca2ec63c5aa6" data-source="For a sample of an embedded structure that is not flattened, see &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Structures Sample&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">有关未平展的嵌入结构的示例，请参阅<a href="https://msdn.microsoft.com/zh-cn/library/eadtsekz(v=vs.110).aspx">“结构”示例</a>。</sentencetext></span>  </p><p>
          <span id="mt79" class="sentence" data-guid="db8d4e791224247e9de10611a1daddc9" data-source="The FindFile sample uses the following unmanaged function, shown with its original function declaration:  " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">FindFile 示例使用以下的非托管函数（与其原始函数声明一同显示）：  </sentencetext></span>
        </p><ul class="unordered"><li><p>
              
                <span id="mt80" class="sentence" data-guid="5e0381739cd5e01db78f06bc7239b409" data-source="&lt;strong&gt;FindFirstFile&lt;/strong&gt; exported from Kernel32.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 Kernel32.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">FindFirstFile</strong>。</sentencetext></span>
              
            </p>
    <div id="code-snippet-7" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>HANDLE FindFirstFile(LPCTSTR lpFileName, LPWIN32_FIND_DATA lpFindFileData);
</pre></div>
            </div>
        </div>
    </div>
</li></ul><p>
          <span id="mt81" class="sentence" data-guid="a7c042a36dce740a4adbc9cc7eb92a6c" data-source="The original structure passed to the function contains the following elements:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递至函数的原始结构包含以下元素：</sentencetext></span>
        </p>
    <div id="code-snippet-8" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>typedef struct _WIN32_FIND_DATA 
{
  DWORD    dwFileAttributes; 
  FILETIME ftCreationTime; 
  FILETIME ftLastAccessTime; 
  FILETIME ftLastWriteTime; 
  DWORD    nFileSizeHigh; 
  DWORD    nFileSizeLow; 
  DWORD    dwReserved0; 
  DWORD    dwReserved1; 
  TCHAR    cFileName[ MAX_PATH ]; 
  TCHAR    cAlternateFileName[ 14 ]; 
} WIN32_FIND_DATA, *PWIN32_FIND_DATA;
</pre></div>
            </div>
        </div>
    </div>
<p>
          <span id="mt82" class="sentence" data-guid="f24fd51cd1dfcbcb402f1a8bdb7c9be5" data-source="In this sample, the &lt;span class=&quot;code&quot;&gt;FindData&lt;/span&gt; class contains a corresponding data member for each element of the original structure and the embedded structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在此示例中，<span class="code" xmlns="http://www.w3.org/1999/xhtml">FindData</span> 类包含原始结构和嵌入结构中每个元素的对应数据成员。</sentencetext></span>  <span id="mt83" class="sentence" data-guid="9f73059cece8edc8571505c450b3261f" data-source="In place of two original character buffers, the class substitutes strings." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">如果存在 2 个原始字符缓冲区，类将替换字符串。</sentencetext></span>  <span id="mt84" class="sentence" data-guid="5c6223ee9356bb84721cdefbc85d0be8" data-source="&lt;strong&gt;MarshalAsAttribute&lt;/strong&gt; sets the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;UnmanagedType&lt;/span&gt;&lt;/span&gt; enumeration to &lt;strong&gt;ByValTStr&lt;/strong&gt;, which is used to identify the inline, fixed-length character arrays that appear within the unmanaged structures." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <strong xmlns="http://www.w3.org/1999/xhtml">MarshalAsAttribute</strong> 将 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.unmanagedtype(v=vs.110).aspx">UnmanagedType</a> 枚举设置为 <strong xmlns="http://www.w3.org/1999/xhtml">ByValTStr</strong>，它用于标识非托管结构中出现的具有固定长度的内联字符数组。</sentencetext></span>  </p><p>
          <span id="mt85" class="sentence" data-guid="acc6fc01a2c872575b8e1809e4d962f7" data-source="The &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains a managed prototype of the &lt;span class=&quot;code&quot;&gt;FindFirstFile&lt;/span&gt; method, which passes the &lt;span class=&quot;code&quot;&gt;FindData&lt;/span&gt; class as a parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含 <span class="code" xmlns="http://www.w3.org/1999/xhtml">FindFirstFile</span> 方法的托管原型，此方法将 <span class="code" xmlns="http://www.w3.org/1999/xhtml">FindData</span> 类作为参数传递。</sentencetext></span>  <span id="mt86" class="sentence" data-guid="db628ae3430dba23cce05657731770fc" data-source="The parameter must be declared with the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;InAttribute&lt;/span&gt;&lt;/span&gt; and &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;OutAttribute&lt;/span&gt;&lt;/span&gt; attributes because classes, which are reference types, are passed as In parameters by default." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此参数必须使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.inattribute(v=vs.110).aspx">InAttribute</a> 和 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.outattribute(v=vs.110).aspx">OutAttribute</a> 属性进行声明，因为作为引用类型的类默认传递为 In 参数。</sentencetext></span>  </p></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">声明原型</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-9" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Green;">// Declares a class member for each structure element.</span>
[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Auto)]
<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> FindData
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  fileAttributes = 0;
    <span style="color:Green;">// creationTime was an embedded FILETIME structure.</span>
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  creationTime_lowDateTime = 0 ;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  creationTime_highDateTime = 0;
    <span style="color:Green;">// lastAccessTime was an embedded FILETIME structure.</span>
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  lastAccessTime_lowDateTime = 0;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  lastAccessTime_highDateTime = 0;
    <span style="color:Green;">// lastWriteTime was an embedded FILETIME structure.</span>
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  lastWriteTime_lowDateTime = 0;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  lastWriteTime_highDateTime = 0;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  nFileSizeHigh = 0;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  nFileSizeLow = 0;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  dwReserved0 = 0;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span>  dwReserved1 = 0;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=260)]
    <span style="color:Blue;">public</span> String  fileName = <span style="color:Blue;">null</span>;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=14)]
    <span style="color:Blue;">public</span> String  alternateFileName = <span style="color:Blue;">null</span>;
}

<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> LibWrap
{
    <span style="color:Green;">// Declares a managed prototype for the unmanaged function.</span>
    [DllImport(<span style="color:#A31515;">"Kernel32.dll"</span>, CharSet=CharSet.Auto)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> IntPtr FindFirstFile(<span style="color:Blue;">string</span> fileName, [In, Out]
        FindData findFileData);
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">调用函数</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-10" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> App
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
    {
        FindData fd = <span style="color:Blue;">new</span> FindData();
        IntPtr handle = LibWrap.FindFirstFile(<span style="color:#A31515;">"C:\\*.*"</span>, fd);
        Console.WriteLine(<span style="color:#A31515;">"The first file: {0}"</span>, fd.fileName);
    }
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">“联合”示例</span></a><div id="Anchor_2" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_2" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p>
          <span id="mt92" class="sentence" data-guid="14b21453579756e772e5f1d73a32d3e4" data-source="This sample demonstrates how to pass structures containing only value types, and structures containing a value type and a string as parameters to an unmanaged function expecting a union." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例演示了如何将仅包含值类型的结构以及包含值类型和字符串的结构作为参数传递至需要联合的非托管函数。</sentencetext></span>  <span id="mt93" class="sentence" data-guid="9cbce4cd7d01b715d5cc4f95c8bbce65" data-source="A union represents a memory location that can be shared by two or more variables." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">联合是指可由两个或多个变量共享的内存位置。</sentencetext></span>  </p><p>
          <span id="mt94" class="sentence" data-guid="24afea4040a9e6aa95b3d09c9b2904d8" data-source="The Unions sample uses the following unmanaged function, shown with its original function declaration:  " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">“联合”示例使用以下非托管函数（与其原始函数声明一同显示）：  </sentencetext></span>
        </p><ul class="unordered"><li><p>
              
                <span id="mt95" class="sentence" data-guid="92104c4aca99bbfcad7cf62a46db9c97" data-source="&lt;strong&gt;TestUnion&lt;/strong&gt; exported from PinvokeLib.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestUnion</strong>。</sentencetext></span>
              
            </p>
    <div id="code-snippet-11" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>void TestUnion(MYUNION u, int type);
</pre></div>
            </div>
        </div>
    </div>
</li></ul><p>
          <span id="mt96" class="sentence" data-guid="9c8eba86b0632ce2c741b39a600746d4" data-source="&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;PinvokeLib.dll&lt;/span&gt;&lt;/span&gt; is a custom unmanaged library that contains an implementation for the previously listed function and two unions, &lt;strong&gt;MYUNION&lt;/strong&gt; and &lt;strong&gt;MYUNION2&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/as6wyhwt(v=vs.110).aspx">PinvokeLib.dll</a> 是一种自定义的非托管库，包含上述函数和两个联合（<strong xmlns="http://www.w3.org/1999/xhtml">MYUNION</strong> 和 <strong xmlns="http://www.w3.org/1999/xhtml">MYUNION2</strong>）的实现。</sentencetext></span>  <span id="mt97" class="sentence" data-guid="c47efbfe17136344d079476ad1b8ebf0" data-source="The unions contain the following elements:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">联合包含以下元素：</sentencetext></span>  </p>
    <div id="code-snippet-12" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>union MYUNION
{
    int number;
    double d;
}

union MYUNION2
{
    int i;
    char str[128];
};
</pre></div>
            </div>
        </div>
    </div>
<p>
          <span id="mt98" class="sentence" data-guid="6f077472b9be3e67c7447320463c43d9" data-source="In managed code, unions are defined as structures." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在托管代码中，将联合定义为结构。</sentencetext></span>  <span id="mt99" class="sentence" data-guid="c4c56b979d57239f6efb61cddf2be1e8" data-source="The &lt;span class=&quot;code&quot;&gt;MyUnion&lt;/span&gt; structure contains two value types as its members: an integer and a double." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnion</span> 结构包含两个值类型（整数和双精度值），将其作为成员。</sentencetext></span>  <span id="mt100" class="sentence" data-guid="7ff205bfdebe610dd7f5f561501d4905" data-source="The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;StructLayoutAttribute&lt;/span&gt;&lt;/span&gt; attribute is set to control the precise position of each data member." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.structlayoutattribute(v=vs.110).aspx">StructLayoutAttribute</a> 属性设置为控制每个数据成员的精确位置。</sentencetext></span>  <span id="mt101" class="sentence" data-guid="c0fe6e88a89ebad3c39263698303b234" data-source="The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;FieldOffsetAttribute&lt;/span&gt;&lt;/span&gt; attribute provides the physical position of fields within the unmanaged representation of a union." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.fieldoffsetattribute(v=vs.110).aspx">FieldOffsetAttribute</a> 属性提供联合的非托管表示形式中字段的物理位置。</sentencetext></span>  <span id="mt102" class="sentence" data-guid="eda9da94c6b5908f6d8874620e5f0a32" data-source="Notice that both members have the same offset values, so the members can define the same piece of memory." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">请注意，这两个成员具有相同的偏移值，因此成员可以定义相同的内存块数。</sentencetext></span>  </p><p>
          <span id="mt103" class="sentence" data-guid="764fd2f7210454b1f63b888b374b895b" data-source="&lt;span class=&quot;code&quot;&gt;MyUnion2_1&lt;/span&gt; and &lt;span class=&quot;code&quot;&gt;MyUnion2_2&lt;/span&gt; contain a value type (integer) and a string, respectively." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnion2_1</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnion2_2</span> 分别包含值类型（整数）和字符串。</sentencetext></span>  <span id="mt104" class="sentence" data-guid="c1dd3103dceae09ea1ee495a0a92d11a" data-source="In managed code, value types and reference types are not permitted to overlap." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在托管代码中，值类型和引用类型不允许重叠。</sentencetext></span>  <span id="mt105" class="sentence" data-guid="fd285164089ecaa19d15328e7ed5c532" data-source="This sample uses method overloading to enable the caller to use both types when calling the same unmanaged function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例使用方法重载以使调用方在调用同一个非托管函数时能够使用这两种类型。</sentencetext></span>  <span id="mt106" class="sentence" data-guid="64b6b887bc4f669e0eba70e34467a4ab" data-source="The layout of &lt;span class=&quot;code&quot;&gt;MyUnion2_1&lt;/span&gt; is explicit and has a precise offset value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnion2_1</span> 的布局是显式的且具有准确的偏移值。</sentencetext></span>  <span id="mt107" class="sentence" data-guid="bcb8c7b2e5e00337e64503c1f582c178" data-source="In contrast, &lt;span class=&quot;code&quot;&gt;MyUnion2_2&lt;/span&gt; has a sequential layout, because explicit layouts are not permitted with reference types." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">与此相反，<span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnion2_2</span> 的布局是按顺序的，因为不允许引用类型使用显式布局。</sentencetext></span>  <span id="mt108" class="sentence" data-guid="313f6050bdf69a1e61d6b4f72362b7ca" data-source="The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;MarshalAsAttribute&lt;/span&gt;&lt;/span&gt; attribute sets the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;UnmanagedType&lt;/span&gt;&lt;/span&gt; enumeration to &lt;strong&gt;ByValTStr&lt;/strong&gt;, which is used to identify the inline, fixed-length character arrays that appear within the unmanaged representation of the union." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshalasattribute(v=vs.110).aspx">MarshalAsAttribute</a> 属性将 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.unmanagedtype(v=vs.110).aspx">UnmanagedType</a> 枚举设置为 <strong xmlns="http://www.w3.org/1999/xhtml">ByValTStr</strong>，它用于标识在联合的非托管表示形式中出现的具有固定长度的内联字符数组。</sentencetext></span>  </p><p>
          <span id="mt109" class="sentence" data-guid="52e14f2148a4ab493e6e95df67e6b959" data-source="The &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains the prototypes for the &lt;span class=&quot;code&quot;&gt;TestUnion&lt;/span&gt; and &lt;span class=&quot;code&quot;&gt;TestUnion2&lt;/span&gt; methods." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestUnion</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestUnion2</span> 方法的原型。</sentencetext></span>  <span id="mt110" class="sentence" data-guid="ec936def732cd485b708707c525e0400" data-source="&lt;span class=&quot;code&quot;&gt;TestUnion2&lt;/span&gt; is overloaded to declare &lt;span class=&quot;code&quot;&gt;MyUnion2_1&lt;/span&gt; or &lt;span class=&quot;code&quot;&gt;MyUnion2_2&lt;/span&gt; as parameters." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">已重载 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestUnion2</span> 以将 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnion2_1</span> 或 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnion2_2</span> 声明为参数。</sentencetext></span>  </p></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">声明原型</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-13" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Green;">// Declares managed structures instead of unions.</span>
[StructLayout(LayoutKind.Explicit)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyUnion
{
    [FieldOffset(0)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> i;
    [FieldOffset(0)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">double</span> d;
}

[StructLayout(LayoutKind.Explicit, Size=128)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyUnion2_1
{
    [FieldOffset(0)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> i;
}

[StructLayout(LayoutKind.Sequential)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyUnion2_2
{
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=128)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">string</span> str;
}

<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> LibWrap
{
    <span style="color:Green;">// Declares managed prototypes for unmanaged function.</span>
    [DllImport( <span style="color:#A31515;">"..\\LIB\\PInvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> TestUnion(MyUnion u, <span style="color:Blue;">int</span> type);

    [DllImport( <span style="color:#A31515;">"..\\LIB\\PInvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> TestUnion2(MyUnion2_1 u, <span style="color:Blue;">int</span> type);

    [DllImport( <span style="color:#A31515;">"..\\LIB\\PInvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> TestUnion2(MyUnion2_2 u, <span style="color:Blue;">int</span> type);
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">调用函数</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-14" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> App
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
    {
        MyUnion mu = <span style="color:Blue;">new</span> MyUnion();
        mu.i = 99;
        LibWrap.TestUnion(mu, 1);

        mu.d = 99.99;
        LibWrap.TestUnion(mu, 2);

        MyUnion2_1 mu2_1 = <span style="color:Blue;">new</span> MyUnion2_1();
        mu2_1.i = 99;
        LibWrap.TestUnion2(mu2_1, 1);

        MyUnion2_2 mu2_2 = <span style="color:Blue;">new</span> MyUnion2_2();
        mu2_2.str = <span style="color:#A31515;">"*** string ***"</span>;
        LibWrap.TestUnion2(mu2_2, 2);
    }
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">SysTime 示例</span></a><div id="Anchor_3" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_3" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p>
          <span id="mt116" class="sentence" data-guid="ae59f265d7d452203ac72c77c946429b" data-source="This sample demonstrates how to pass a pointer to a class to an unmanaged function that expects a pointer to a structure. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例演示了如何将指向类的指针传递到需要指向结构的指针的非托管函数。</sentencetext></span>
        </p><p>
          <span id="mt117" class="sentence" data-guid="66f94826651906414ac1b90d4fd58c25" data-source="The SysTime sample uses the following unmanaged function, shown with its original function declaration:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">SysTime 示例使用以下非托管函数（与其其原始函数声明一同显示）：</sentencetext></span>
        </p><ul class="unordered"><li><p>
              
                <span id="mt118" class="sentence" data-guid="032fbd4e02fd892386051bfee3b1ed6a" data-source="&lt;strong&gt;GetSystemTime&lt;/strong&gt; exported from Kernel32.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 Kernel32.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">GetSystemTime</strong>。</sentencetext></span>
              
            </p>
    <div id="code-snippet-15" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>VOID GetSystemTime(LPSYSTEMTIME lpSystemTime);
</pre></div>
            </div>
        </div>
    </div>
</li></ul><p>
          <span id="mt119" class="sentence" data-guid="a7c042a36dce740a4adbc9cc7eb92a6c" data-source="The original structure passed to the function contains the following elements:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递至函数的原始结构包含以下元素：</sentencetext></span>
        </p>
    <div id="code-snippet-16" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>typedef struct _SYSTEMTIME { 
    WORD wYear; 
    WORD wMonth; 
    WORD wDayOfWeek; 
    WORD wDay; 
    WORD wHour; 
    WORD wMinute; 
    WORD wSecond; 
    WORD wMilliseconds; 
} SYSTEMTIME, *PSYSTEMTIME;
</pre></div>
            </div>
        </div>
    </div>
<p>
          <span id="mt120" class="sentence" data-guid="abbf7f4d1ddd4a6eff30728dff0332e4" data-source="In this sample, the &lt;span class=&quot;code&quot;&gt;SystemTime&lt;/span&gt; class contains the elements of the original structure represented as class members." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在此示例中，<span class="code" xmlns="http://www.w3.org/1999/xhtml">SystemTime</span> 类包含原始结构中表示为类成员的元素。</sentencetext></span>  <span id="mt121" class="sentence" data-guid="f9ddf559d33a731eb179853a5de9fb5f" data-source="The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;StructLayoutAttribute&lt;/span&gt;&lt;/span&gt; attribute is set to ensure that the members are arranged in memory sequentially, in the order in which they appear." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">设置 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.structlayoutattribute(v=vs.110).aspx">StructLayoutAttribute</a> 特性，以确保成员在内存中按照它们出现的顺序进行排列。</sentencetext></span>  </p><p>
          <span id="mt122" class="sentence" data-guid="97d9185693f8af013870fc82ea1b601f" data-source="The &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains a managed prototype of the &lt;span class=&quot;code&quot;&gt;GetSystemTime&lt;/span&gt; method, which passes the &lt;span class=&quot;code&quot;&gt;SystemTime&lt;/span&gt; class as an In/Out parameter by default." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含 <span class="code" xmlns="http://www.w3.org/1999/xhtml">GetSystemTime</span> 方法的托管原型，此方法在默认情况下将 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SystemTime</span> 类作为 In/Out 参数传递。</sentencetext></span>  <span id="mt123" class="sentence" data-guid="db628ae3430dba23cce05657731770fc" data-source="The parameter must be declared with the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;InAttribute&lt;/span&gt;&lt;/span&gt; and &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;OutAttribute&lt;/span&gt;&lt;/span&gt; attributes because classes, which are reference types, are passed as In parameters by default." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此参数必须使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.inattribute(v=vs.110).aspx">InAttribute</a> 和 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.outattribute(v=vs.110).aspx">OutAttribute</a> 属性进行声明，因为作为引用类型的类默认传递为 In 参数。</sentencetext></span>  <span id="mt124" class="sentence" data-guid="53b0fd17b59c457621fc15f2fa4b33dc" data-source="For the caller to receive the results, these &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;directional attributes&lt;/span&gt;&lt;/span&gt; must be applied explicitly." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">为使调用方接收结果，这些<a href="https://msdn.microsoft.com/zh-cn/library/77e6taeh(v=vs.110).aspx">方向属性</a>必须显式应用。</sentencetext></span>  <span id="mt125" class="sentence" data-guid="0b9c66c76857609ec64e3e403af1632c" data-source="The &lt;span class=&quot;code&quot;&gt;App&lt;/span&gt; class creates a new instance of the &lt;span class=&quot;code&quot;&gt;SystemTime&lt;/span&gt; class and accesses its data fields." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">App</span> 类创建 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SystemTime</span> 类的新实例，并访问它的数据字段。</sentencetext></span>  </p></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">代码示例</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-17" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">using</span> System;
<span style="color:Blue;">using</span> System.Runtime.InteropServices;     <span style="color:Green;">// For StructLayout, DllImport</span>

[StructLayout(LayoutKind.Sequential)]
<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> SystemTime
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> year;
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> month;
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> weekday;
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> day;
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> hour;
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> minute;
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> second;
    <span style="color:Blue;">public</span> <span style="color:Blue;">ushort</span> millisecond;
}

<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> LibWrap
{
    <span style="color:Green;">// Declares a managed prototype for the unmanaged function using Platform Invoke.</span>
    [DllImport(<span style="color:#A31515;">"Kernel32.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> GetSystemTime([In,Out] SystemTime st);
}

<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> App
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
    {
        Console.WriteLine(<span style="color:#A31515;">"C# SysTime Sample using Platform Invoke"</span>);
        SystemTime st = <span style="color:Blue;">new</span> SystemTime();
        LibWrap.GetSystemTime(st);
        Console.Write(<span style="color:#A31515;">"The Date is: "</span>);
        Console.Write(<span style="color:#A31515;">"{0} {1} {2}"</span>,  st.month, st.day, st.year );
    }
}

<span style="color:Green;">// The program produces output similar to the following:</span>
<span style="color:Green;">//</span>
<span style="color:Green;">// C# SysTime Sample using Platform Invoke</span>
<span style="color:Green;">// The Date is: 3 21 2010</span>
</pre></div>
            </div>
        </div>
    </div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">OutArrayOfStructs 示例</span></a><div id="Anchor_4" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_4" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p>
          <span id="mt129" class="sentence" data-guid="0dfc0c5326453fab71b67a98fe74b347" data-source="This sample shows how to pass an array of structures that contains integers and strings as Out parameters to an unmanaged function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例显示如何将包含整数和字符串的结构数组作为 Out 参数传递到非托管函数。</sentencetext></span>
        </p><p>
          
            <span id="mt130" class="sentence" data-guid="f0d130b9025010c0f0467b4e05720b05" data-source="This sample demonstrates how to call a native function by using the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Marshal&lt;/span&gt;&lt;/span&gt; class and by using unsafe code. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例演示如何通过使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal(v=vs.110).aspx">Marshal</a> 类和使用不安全代码调用本机函数。</sentencetext></span>
          
        </p><p>
          <span id="mt131" class="sentence" data-guid="bdea7870a98709517fc90789b9893611" data-source="This sample uses a wrapper functions and platform invokes defined in &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;PinvokeLib.dll&lt;/span&gt;&lt;/span&gt;, also provided in the source files." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此示例使用 <a href="https://msdn.microsoft.com/zh-cn/library/as6wyhwt(v=vs.110).aspx">PinvokeLib.dll</a> 中定义（且位于源文件）的包装器函数和平台调用。</sentencetext></span>  <span id="mt132" class="sentence" data-guid="2e69cecf9fe06b75a656f5285574441b" data-source="It uses the &lt;span class=&quot;code&quot;&gt;TestOutArrayOfStructs&lt;/span&gt; function and the &lt;span class=&quot;code&quot;&gt;MYSTRSTRUCT2&lt;/span&gt; structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">它使用 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestOutArrayOfStructs</span> 函数和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MYSTRSTRUCT2</span> 结构。</sentencetext></span>  <span id="mt133" class="sentence" data-guid="1fb4204035fa277464f6d639017bb4d8" data-source="The structure contains the following elements:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">结构包含以下元素：</sentencetext></span>  </p>
    <div id="code-snippet-18" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>typedef struct _MYSTRSTRUCT2
{
   char* buffer;
   UINT size; 
} MYSTRSTRUCT2;
</pre></div>
            </div>
        </div>
    </div>
<p>
          <span id="mt134" class="sentence" data-guid="57b9600fc211a76689bba1114ad92050" data-source="The &lt;span class=&quot;code&quot;&gt;MyStruct&lt;/span&gt; class contains a string object of ANSI characters." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyStruct</span> 类包含 ANSI 字符的字符串对象。</sentencetext></span>  <span id="mt135" class="sentence" data-guid="5ac0df3032745e7cbc732ba0f7d94a4f" data-source="The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;CharSet&lt;/span&gt;&lt;/span&gt; field specifies ANSI format." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.dllimportattribute.charset(v=vs.110).aspx">CharSet</a> 字段指定 ANSI 格式。</sentencetext></span>  <span id="mt136" class="sentence" data-guid="4237216479e2e0bdd8c14470ebd6947a" data-source="&lt;span class=&quot;code&quot;&gt;MyUnsafeStruct&lt;/span&gt;, is a structure containing an &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;IntPtr&lt;/span&gt;&lt;/span&gt; type instead of a string." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnsafeStruct</span> 是一种包含 <a href="https://msdn.microsoft.com/zh-cn/library/system.intptr(v=vs.110).aspx">IntPtr</a> 类型（而非字符串）的结构。</sentencetext></span>  </p><p>
          <span id="mt137" class="sentence" data-guid="e0e7dcb1949c297a9aff39bf4554c45b" data-source="The &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains the overloaded &lt;span class=&quot;code&quot;&gt;TestOutArrayOfStructs&lt;/span&gt; prototype method." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含已重载 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestOutArrayOfStructs</span> 原型方法。</sentencetext></span>  <span id="mt138" class="sentence" data-guid="1f68188884827cdcc6e1d8ab0bb8dfd5" data-source="If a method declares a pointer as a parameter, the class should be marked with the &lt;strong&gt;unsafe&lt;/strong&gt; keyword." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">如果方法将指针声明为参数，则应使用 <strong xmlns="http://www.w3.org/1999/xhtml">unsafe</strong> 关键字标记类。</sentencetext></span>  <span id="mt139" class="sentence" data-guid="963676e6f72c26784961df628a5e70f9" data-source="Because Visual Basic 2005 cannot use unsafe code, the overloaded method, unsafe modifier, and the &lt;span class=&quot;code&quot;&gt;MyUnsafeStruct&lt;/span&gt; structure are unnecessary." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">因为 Visual Basic 2005 无法使用不安全代码，所以已重载方法、不安全修饰符和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnsafeStruct</span> 结构不是必需的。</sentencetext></span>  </p><p>
          <span id="mt140" class="sentence" data-guid="c040285d8a4bb5a615d97f82afe70224" data-source="The &lt;span class=&quot;code&quot;&gt;App&lt;/span&gt; class implements the &lt;span class=&quot;code&quot;&gt;UsingMarshaling&lt;/span&gt; method, which performs all the tasks necessary to pass the array." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">App</span> 类实现 <span class="code" xmlns="http://www.w3.org/1999/xhtml">UsingMarshaling</span> 方法，此方法执行传递数组所需的全部任务。</sentencetext></span>  <span id="mt141" class="sentence" data-guid="efee23c82bf8ec2e7c869720a009a4c5" data-source="The array is marked with the &lt;strong&gt;out&lt;/strong&gt; (&lt;strong&gt;ByRef&lt;/strong&gt; in Visual Basic) keyword to indicate that data passes from callee to caller." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">使用 <strong xmlns="http://www.w3.org/1999/xhtml">out</strong>（Visual Basic 中的 <strong xmlns="http://www.w3.org/1999/xhtml">ByRef</strong>）关键字标记数组，以指示数据从被调用方传递至调用方。</sentencetext></span>  <span id="mt142" class="sentence" data-guid="1ea916405f6eea99f8c69df15959a5bd" data-source="The implementation uses the following &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Marshal&lt;/span&gt;&lt;/span&gt; class methods:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">实现使用以下 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal(v=vs.110).aspx">Marshal</a> 类方法：</sentencetext></span>  </p><ul class="unordered"><li><p>
              
                <span id="mt143" class="sentence" data-guid="5abdd4bb7d9bb1055e923f3f8cf336a1" data-source="&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;PtrToStructure&lt;/span&gt;&lt;/span&gt; to marshal data from the unmanaged buffer to a managed object." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/30ex8z62(v=vs.110).aspx">PtrToStructure</a>，用于将数据从非托管缓冲区封送到托管对象。</sentencetext></span>
              
            </p></li><li><p>
              
                <span id="mt144" class="sentence" data-guid="855bb15082e26b57baccaaeb46cd4557" data-source="&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;DestroyStructure&lt;/span&gt;&lt;/span&gt; to release the memory reserved for strings in the structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/df3k5fh1(v=vs.110).aspx">DestroyStructure</a>用于释放为结构中的字符串保留的内存。</sentencetext></span>
              
            </p></li><li><p>
              
                <span id="mt145" class="sentence" data-guid="cb1768e0417ef7da08f1c3513e9c1c35" data-source="&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;FreeCoTaskMem&lt;/span&gt;&lt;/span&gt; to release the memory reserved for the array." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal.freecotaskmem(v=vs.110).aspx">FreeCoTaskMem</a>用于释放为数组保留的内存。</sentencetext></span>
              
            </p></li></ul><p>
          <span id="mt146" class="sentence" data-guid="58a2ba8589888e3630ded86be7405955" data-source="As previously mentioned, C# allows unsafe code and Visual Basic 2005 does not." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">正如上文所述，C# 允许不安全代码而 Visual Basic 2005 不允许。</sentencetext></span>  <span id="mt147" class="sentence" data-guid="7c175a723a82d830e98badadbe6af67b" data-source="In the C# sample, &lt;span class=&quot;code&quot;&gt;UsingUnsafePointer&lt;/span&gt; is an alternative method implementation that uses pointers instead of the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Marshal&lt;/span&gt;&lt;/span&gt; class to pass back the array containing the &lt;span class=&quot;code&quot;&gt;MyUnsafeStruct&lt;/span&gt; structure." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在 C# 示例中，<span class="code" xmlns="http://www.w3.org/1999/xhtml">UsingUnsafePointer</span> 是一种替代性方法实现，使用指针（而非 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.marshal(v=vs.110).aspx">Marshal</a> 类）传递会包含 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyUnsafeStruct</span> 结构的数组。</sentencetext></span>  </p></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">声明原型</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-19" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Green;">// Declares a class member for each structure element.</span>
[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi)]
<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> MyStruct
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">string</span> buffer;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> size;
}

<span style="color:Green;">// Declares a structure with a pointer.</span>
[StructLayout(LayoutKind.Sequential)]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyUnsafeStruct
{
    <span style="color:Blue;">public</span> IntPtr buffer;
    <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> size;
}

<span style="color:Blue;">public</span> <span style="color:Blue;">unsafe</span> <span style="color:Blue;">class</span> LibWrap
{
    <span style="color:Green;">// Declares managed prototypes for the unmanaged function.</span>
    [DllImport(<span style="color:#A31515;">"..\\LIB\\PInvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> TestOutArrayOfStructs(<span style="color:Blue;">out</span> <span style="color:Blue;">int</span> size,
        <span style="color:Blue;">out</span> IntPtr outArray);

    [DllImport(<span style="color:#A31515;">"..\\LIB\\PInvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> TestOutArrayOfStructs(<span style="color:Blue;">out</span> <span style="color:Blue;">int</span> size,
        MyUnsafeStruct** outArray);
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">调用函数</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-20" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> App
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
    {
        Console.WriteLine(<span style="color:#A31515;">"\nUsing marshal class\n"</span>);
        UsingMarshaling();
        Console.WriteLine(<span style="color:#A31515;">"\nUsing unsafe code\n"</span>);
        UsingUnsafePointer();
    }

    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> UsingMarshaling()
    {
        <span style="color:Blue;">int</span> size;
        IntPtr outArray;

        LibWrap.TestOutArrayOfStructs(<span style="color:Blue;">out</span> size, <span style="color:Blue;">out</span> outArray);
        MyStruct[] manArray = <span style="color:Blue;">new</span> MyStruct[size];
        IntPtr current = outArray;
        <span style="color:Blue;">for</span> (<span style="color:Blue;">int</span> i = 0; i &lt; size; i++)
        {
            manArray[i] = <span style="color:Blue;">new</span> MyStruct();
            Marshal.PtrToStructure(current, manArray[i]);

            <span style="color:Green;">//Marshal.FreeCoTaskMem( (IntPtr)Marshal.ReadInt32( current ));</span>
            Marshal.DestroyStructure(current, <span style="color:Blue;">typeof</span>(MyStruct));
            current = (IntPtr)((<span style="color:Blue;">long</span>)current + Marshal.SizeOf(manArray[i]));

            Console.WriteLine(<span style="color:#A31515;">"Element {0}: {1} {2}"</span>, i, manArray[i].buffer,
                manArray[i].size);
        }
        Marshal.FreeCoTaskMem(outArray);
    }

    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">unsafe</span> <span style="color:Blue;">void</span> UsingUnsafePointer()
    {
        <span style="color:Blue;">int</span> size;
        MyUnsafeStruct* pResult;

        LibWrap.TestOutArrayOfStructs(<span style="color:Blue;">out</span> size, &amp;pResult);
        MyUnsafeStruct* pCurrent = pResult;
        <span style="color:Blue;">for</span> (<span style="color:Blue;">int</span> i = 0; i &lt; size; i++, pCurrent++)
        {
            Console.WriteLine(<span style="color:#A31515;">"Element {0}: {1} {2}"</span>, i,
                Marshal.PtrToStringAnsi(pCurrent-&gt;buffer), pCurrent-&gt;size);
            Marshal.FreeCoTaskMem(pCurrent-&gt;buffer);
        }
        Marshal.FreeCoTaskMem((IntPtr)pResult);
    }
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">请参阅</span></a><div id="Anchor_5" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/eshywdt7(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_5" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><p><a href="https://msdn.microsoft.com/zh-cn/library/fzhhdwae(v=vs.110).aspx">用平台调用封送数据</a><br><a href="https://msdn.microsoft.com/zh-cn/library/ac7ay120(v=vs.110).aspx">Platform Invoke Data Types</a><br><a href="https://msdn.microsoft.com/zh-cn/library/e8w969hb(v=vs.110).aspx">封送处理字符串</a><br><a href="https://msdn.microsoft.com/zh-cn/library/dd93y453(v=vs.110).aspx">Marshaling Arrays of Types</a><br></p></div></div></div>
    </div>
  </div>
</div>
  

    </div>



        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="SmQfhoz4F6z7yUxUzjNV-1HJBF9Qx2DhOpuJAxk4XQl-wlBJ4S6aSWP8mTx_lmvKznreoKT-nEkXFMMcjfAHPdwquRo1">
<input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/rate/eshywdt7(d=printer,v=vs.110).aspx">
<input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/additional/eshywdt7(d=printer,v=vs.110).aspx">
<input id="isTopicRated" type="hidden" value="false">




    <div id="lib-footer">
        

    
    <link type="text/css" rel="stylesheet">
    
    <div id="ux-footer" class="" style="" dir="ltr">


    <div id="standardRatingBefore" class="clear stdr-container-before"></div>
    <div id="standardRating" class="stdr-container" ms.pgarea="body">
        <div class="stdr-close"></div>
        <div class="stdr-vote stdr-content">
            <div class="stdr-content">
                <span class="stdr-votetitle">此页面有帮助吗？</span>
                <button class="stdr-yes" aria-label="是，此页面很有帮助">是</button>
                <button class="stdr-no" aria-label="不，此页面没有任何帮助">否</button>
                <input id="s_ratingValue" type="hidden" value="">
            </div>
        </div>
        <div class="stdr-feedback" style="display: none">
            <div class="stdr-form">
                <div class="stdr-fieldtitle">更多反馈？</div>
                <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea>
                <div>
                    <span class="stdr-count"><span class="stdr-charcnt">1500</span> 个剩余字符</span>
                    <div class="stdr-buttons">
                        <button class="stdr-provide" aria-label="提交我的其他反馈">提交</button>
                        <button class="stdr-skip" aria-label="跳过其他反馈">跳过此步</button>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div class="stdr-thanks" style="display: none">
            <div class="stdr-content">
                <span class="stdr-thankyou">谢谢！</span>
                <span class="stdr-appreciate">我们非常感谢您的反馈。</span>
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
    <div id="standardRatingPlaceholder" style="display: none"></div>
    

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">开发人员中心</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/zh-cn/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">更多...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">学习资源</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft 虚拟学院</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">第 9 频道</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN 杂志</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">社区</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/zh-cn/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">论坛</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">博客</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">支持</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">自助支持</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">计划</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark（针对新创企业）</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">创新杯</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/zh-cn/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2feshywdt7(d%3dprinter%2cv%3dvs.110).aspx%3flan%3dCSharp%26cc%3dn%26trm%3dtra%26view%3dbook">
        <a href="http://msdn.microsoft.com/#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="更改您的语言">中国 (简体中文)</a>
    </form>


            </span>

            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">新闻稿</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">隐私&amp; Cookie</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">使用条款</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">商标</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2016 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>


        <div class="footerPrintView">
            <div class="footerCopyrightPrintView">© 2016 Microsoft</div>
        </div>

        
        

        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17">



        <input id="MtpsDevice" type="hidden" value="Printer">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

        
        
        
            
        






<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="https://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>








<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="TXxf2QtrmAiO2mEkmsQk9pqQ6MAiY1VBenJ2sD9NDcSUQvW9cSbtGswxZNXaXrUNxweA0Uopj-bkzRBbCHKiGNR3BX01">
</div>


    </div>

    
    

    

    
    
    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/zh-cn/library/eshywdt7(d=printer,l=zh-cn,v=vs.110).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027zh-cn\u0027;\n  var wtsp = \u0027msdnlib_dotnet\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:StandardRating,2:Footer,0:Topic,4:PabTopic,5:webtrendsscript,0:AppInsightsPerf,0:ABTestControl,6:WEDCS,4:CmpgrpForHeader,0:livefyre,0:Comment,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Global/Content:3,/Areas/Library/Content:4,/Areas/Global/Content/Webtrends/resources:5,/Areas/Library/Themes/Base/Content:6\u0026amp;hashKey=BA9931020C89561F32DF1A9F4D3D9490\u0026amp;v=C1A44C493A8E2B533F677094B680D091" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026pgArea=header\u0026brand=Msdn\u0026loc=zh-cn\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=搜索 MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:JumpRedirect,1:PrintExportButton;/Areas/Epx/Themes/Base/Content:0,/Areas/Library/Themes/Base/Content:1\u0026amp;hashKey=7006119E9942EFE11F58E00EDB773584\u0026amp;v=C1A44C493A8E2B533F677094B680D091" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Toc_Fixed,0:CodeSnippet,0:TopicNotInScope,0:CollapsibleArea,0:VersionSelector,0:SurveyBroker;/Areas/Epx/Content/Scripts:0\u0026amp;hashKey=928842C6187B6959419CA6E8B32D31AC\u0026amp;v=C1A44C493A8E2B533F677094B680D091" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>
<link rel="stylesheet" type="text/css" href="./我的集合_files/Combined.css">
    <div id="page">

        

        
    

    
    <link type="text/css" rel="stylesheet">
    
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn">
        

      <header>
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/zh-cn" title="MSDN home">
                  <div id="msft-logo" class="msft-logo"></div>
                </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/zh-cn">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <div class="profileImage"></div>



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=12&ct=1464504569&rver=6.0.5276.0&wp=mcmbi&wlcxt=msdn%24msdn%24msdn&wreply=https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2fhk9wyw21%2528d%3dprinter%2cv%3dvs.110%2529.aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook&lc=2052&id=254354&mkt=zh-cn">登录</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">MSDN 订阅</span>
  </a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x804&slcid=0x804&campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">获取工具</span>
  </a>
</div>
                  </div>                    
                        <div>
                            <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.weibo.com/cnmsdn" id="SocialLinks_2152_8" class="weiboShare" xmlns="http://www.w3.org/1999/xhtml">http://www.weibo.com/cnmsdn</a>
      </li>
      <li>
        <a href="http://aka.ms/msdnwechat" id="SocialLinks_2152_9" class="wechatShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/msdnwechat</a>
      </li>
      <li>
        <a href="http://aka.ms/contactmsdn" id="SocialLinks_2152_10" class="cnContactShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/contactmsdn</a>
      </li>
    </ul>
  </div>
</div>
                        </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">技术</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="云">云</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="应用开发">应用开发</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="数据">数据</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="游戏">游戏</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/internetofthings" title="物联网">物联网</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">下载</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions/" title="MSDN 订阅访问">MSDN 订阅访问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDK">SDK</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="试用软件">试用软件</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="免费下载">免费下载</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office 资源">Office 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 资源">SharePoint Server 2013 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express 资源">SQL Server 2014 Express 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 资源">Windows Server 2012 资源</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">计划</a>
                                <ul class="navL2">
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN 订阅">MSDN 订阅</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="权益">权益</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="学生">学生</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft 学生合作伙伴">Microsoft 学生合作伙伴</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="架构师">架构师</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="案例研究">案例研究</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="蓝图">蓝图</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="博客">博客</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="论坛">论坛</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/applicationbuilder" title="ISV">ISV</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="新手">新手</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="TechRewards">TechRewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/zh-cn" title="Events（事件）">Events（事件）</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">社区</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="论坛">论坛</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://blogs.msdn.microsoft.com/" title="博客">博客</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/zh-cn" title="技术顾问">技术顾问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="第 9 频道">第 9 频道</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)">文档</a>
                                <ul class="navL2">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="API 和参考">API 和参考</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="开发人员中心">开发人员中心</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/">示例</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)">
      </div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    </div>

    
    
    
    <div id="jumpInfo" style="display: none">非常抱歉。你请求的内容已被删除。将在 1 秒内自动重定向。</div>


    
    <div class="printExportMenus ltr">
        <a id="isd_printABook" href="http://msdn.microsoft.com/zh-cn/library/export/help/(d=printer)?returnurl=%2fzh-cn%2flibrary%2fhk9wyw21(d%3dprinter,v%3dvs.110).aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook">
            导出 (<span class="count">0</span>)
        </a>
        <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/hk9wyw21(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book" rel="nofollow">
            打印
        </a>
        <a id="isd_archiveControl" style="display:none;" data-include-archive="显示已存档版本" data-exclude-archive="隐藏已存档版本">
        </a>
    </div>
    
    <div class="printExportMenus ltr">
        <a id="expandCollapseAll" accesskey="e" href="javascript:void(0)" title="Expand/Collapse all sections by pressing Ctrl + Shift + e">全部展开</a>
    </div>

    


        <div id="body" ms.pgarea="body">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="content" class="content">



<input type="hidden" id="printForPab" value="true">



        
<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">封送处理不同类型的数组</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong>
                .NET Framework (current version)
            </strong>
      </div>
      <div id="versionclick">
        <div id="vsseperator" class="cl_lw_vs_seperator"></div>
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        其他版本
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./我的集合_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel">
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/hk9wyw21(d=printer,v=vs.100).aspx">.NET Framework 4</a>
          </li>
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/hk9wyw21(d=printer,v=vs.90).aspx">.NET Framework 3.5</a>
          </li>
          <li class="archived">
            <a href="http://msdn.microsoft.com/zh-cn/library/hk9wyw21(d=printer,v=vs.80).aspx">.NET Framework 2.0</a>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<div class="introduction"><p><span id="mt1" class="sentence" data-guid="71ef7771be1cb37e96ecad5637c941f8" data-source="An array is a reference type in managed code that contains one or more elements of the same type." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">数组是包含有一个或多个相同类型的元素的托管代码中的引用类型。</sentencetext></span><span id="mt2" class="sentence" data-guid="4e0f37917cd29fa091241616527f01cd" data-source=" Although arrays are reference types, they are passed as In parameters to unmanaged functions." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 尽管数组是引用类型，但它们却作为 In 参数传递到非托管函数。</sentencetext></span><span id="mt3" class="sentence" data-guid="52b942f484ce1e565927415a6a4e54bc" data-source=" This behavior is inconsistent with way managed arrays are passed to managed objects, which is as In/Out parameters." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 此行为与托管数组传递到托管对象的方式不一致，数组作为 In/Out 参数进行传递。</sentencetext></span><span id="mt4" class="sentence" data-guid="54871659f8ce24b321046feff1e82427" data-source=" For additional details, see &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Copying and Pinning&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 有关其他详细信息，请参阅 <a href="https://msdn.microsoft.com/zh-cn/library/23acw07k(v=vs.110).aspx">复制和锁定</a>。</sentencetext></span></p><p><span id="mt5" class="sentence" data-guid="25086b28052986a0ee6566f0f5b3e6bb" data-source="The following table lists marshaling options for arrays and describes their usage." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">下表列出了数组的封送处理选项，并描述了它们的用法。</sentencetext></span></p><table responsive="true"><tbody><tr responsive="true"><th><p><span id="mt6" class="sentence" data-guid="f1f713c9e000f5d3f280adbd124df4f5" data-source="Array" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">数组</sentencetext></span></p></th><th><p><span id="mt7" class="sentence" data-guid="67daf92c833c41c95db874e18fcb2786" data-source="Description" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">描述</sentencetext></span></p></th></tr><tr><td data-th="数组"><p><span id="mt8" class="sentence" data-guid="da4633d968c0efe2940dc8231405fd24" data-source="Of integers by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过值传递的整数。</sentencetext></span></p></td><td data-th="描述"><p><span id="mt9" class="sentence" data-guid="fb3227340962e57bc7c04957c4b95df7" data-source="Passes an array of integers as an In parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将整数的数组作为 In 参数进行传递。</sentencetext></span></p></td></tr><tr><td data-th="数组"><p><span id="mt10" class="sentence" data-guid="73ef1a16025896e498a6bbc6d1fe5cc8" data-source="Of integers by reference." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过引用传递的整数。</sentencetext></span></p></td><td data-th="描述"><p><span id="mt11" class="sentence" data-guid="92c4e0f6e98c2b6d57f40f957b58cbc7" data-source="Passes an array of integers as an In/Out parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将整数的数组作为 In/Out 参数进行传递。</sentencetext></span></p></td></tr><tr><td data-th="数组"><p><span id="mt12" class="sentence" data-guid="20f0b782363f170f4713dfa7d7b53b91" data-source="Of integers by value (two-dimensional)." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过值传递的整数（二维）。</sentencetext></span></p></td><td data-th="描述"><p><span id="mt13" class="sentence" data-guid="f606c1d207bae846350bab9100d63c37" data-source="Passes a matrix of integers as an In parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将整数的矩阵作为 In 参数进行传递。</sentencetext></span></p></td></tr><tr><td data-th="数组"><p><span id="mt14" class="sentence" data-guid="70a48c8b72a5ca6a2644e57fb589f0f7" data-source="Of strings by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过值传递的字符串。</sentencetext></span></p></td><td data-th="描述"><p><span id="mt15" class="sentence" data-guid="aeb9d32715f7bb25b4122e1a18e3a2c1" data-source="Passes an array of strings as an In parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将字符串的数组作为 In 参数进行传递。</sentencetext></span></p></td></tr><tr><td data-th="数组"><p><span id="mt16" class="sentence" data-guid="16d73ad1bda03daa20ea7614d4c82ca5" data-source="Of structures with integers." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递具有整数的结构。</sentencetext></span></p></td><td data-th="描述"><p><span id="mt17" class="sentence" data-guid="b7137ecb2ab37a3271c782d7696ab4d3" data-source="Passes an array of structures that contain integers as an In parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将包含整数的结构数组作为 In 参数进行传递。</sentencetext></span></p></td></tr><tr><td data-th="数组"><p><span id="mt18" class="sentence" data-guid="9b0d3f617b5354f8f2cab9934bd0d43c" data-source="Of structures with strings." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递具有字符串的结构。</sentencetext></span></p></td><td data-th="描述"><p><span id="mt19" class="sentence" data-guid="4b7bcc1ff79f97ad232e302accb7c09e" data-source="Passes an array of structures that contain only integers as an In/Out parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将仅包含整数的结构数组作为 In/Out 参数进行传递。</sentencetext></span><span id="mt20" class="sentence" data-guid="3f477e2d69bb62ad6a48cd4361c73e1a" data-source=" Members of the array can be changed." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 可以更改数组的成员。</sentencetext></span></p></td></tr></tbody></table></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">示例</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/hk9wyw21(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p><span id="mt22" class="sentence" data-guid="31e6d65bbde4a3fe3e4805b1f07de959" data-source="This sample demonstrates how to pass the following types of arrays: " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">本示例演示如何传递以下类型的数组：&nbsp;</sentencetext></span></p><ul class="unordered"><li><p><span id="mt23" class="sentence" data-guid="0a5ed1c0b62bd0c3b57019e3adbcc98e" data-source="Array of integers by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过值传递的整数数组。</sentencetext></span></p></li><li><p><span id="mt24" class="sentence" data-guid="6a64ea2a03394eaddaf981c7a0a1aa29" data-source="Array of integers by reference, which can be resized." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过引用传递的整数数组（可以调整大小）。</sentencetext></span></p></li><li><p><span id="mt25" class="sentence" data-guid="26bb1727880b1e1f8a0e7435639c982e" data-source="Multidimensional array (matrix) of integers by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过值传递的整数多维数组（矩阵）。</sentencetext></span></p></li><li><p><span id="mt26" class="sentence" data-guid="cf311ab843580c05aec8ecff4407c83c" data-source="Array of strings by value." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">通过值传递的字符串数组。</sentencetext></span></p></li><li><p><span id="mt27" class="sentence" data-guid="cd0f2c9abb240f79cd7e35a42985ed57" data-source="Array of structures with integers." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递具有整数的结构数组。</sentencetext></span></p></li><li><p><span id="mt28" class="sentence" data-guid="293d8e247257ff0a7886af174416e810" data-source="Array of structures with strings." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">传递具有字符串的结构数组。</sentencetext></span></p></li></ul><p><span id="mt29" class="sentence" data-guid="03c0e9eb0d58506e34a0d680eb96b773" data-source="Unless an array is explicitly marshaled by reference, the default behavior marshals the array as an In parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">除非数组由引用显式地进行封送处理，否则将以默认行为将数组封送为 In 参数。</sentencetext></span><span id="mt30" class="sentence" data-guid="8a4333813c9d25e3781475358008b242" data-source=" You can change this behavior by applying the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;InAttribute&lt;/span&gt;&lt;/span&gt; and &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;OutAttribute&lt;/span&gt;&lt;/span&gt; attributes explicitly." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 通过显示应用 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.inattribute(v=vs.110).aspx">InAttribute</a> 和 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.outattribute(v=vs.110).aspx">OutAttribute</a> 属性，可以更改此行为。</sentencetext></span></p><p><span id="mt31" class="sentence" data-guid="0a8304289616821873aabd061522a59a" data-source="The Arrays sample uses the following unmanaged functions, shown with their original function declaration:  " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">数组示例使用以下非托管函数，这些函数与其原始函数声明一起显示：  </sentencetext></span></p><ul class="unordered"><li><p><span id="mt32" class="sentence" data-guid="a846d4214183c74a7a119d84c9c62683" data-source="&lt;strong&gt;TestArrayOfInts&lt;/strong&gt; exported from PinvokeLib.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestArrayOfInts</strong>。</sentencetext></span></p>
    <div id="code-snippet-1" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int TestArrayOfInts(int* pArray, int pSize);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p><span id="mt33" class="sentence" data-guid="a846d4214183c74a7a119d84c9c62683" data-source="&lt;strong&gt;TestRefArrayOfInts&lt;/strong&gt; exported from PinvokeLib.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestRefArrayOfInts</strong>。</sentencetext></span></p>
    <div id="code-snippet-2" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int TestRefArrayOfInts(int** ppArray, int* pSize);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p><span id="mt34" class="sentence" data-guid="a846d4214183c74a7a119d84c9c62683" data-source="&lt;strong&gt;TestMatrixOfInts&lt;/strong&gt; exported from PinvokeLib.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestMatrixOfInts</strong>。</sentencetext></span></p>
    <div id="code-snippet-3" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int TestMatrixOfInts(int pMatrix[][COL_DIM], int row);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p><span id="mt35" class="sentence" data-guid="a846d4214183c74a7a119d84c9c62683" data-source="&lt;strong&gt;TestArrayOfStrings&lt;/strong&gt; exported from PinvokeLib.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestArrayOfStrings</strong>。</sentencetext></span></p>
    <div id="code-snippet-4" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int TestArrayOfStrings(char** ppStrArray, int size);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p><span id="mt36" class="sentence" data-guid="a846d4214183c74a7a119d84c9c62683" data-source="&lt;strong&gt;TestArrayOfStructs&lt;/strong&gt; exported from PinvokeLib.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestArrayOfStructs</strong>。</sentencetext></span></p>
    <div id="code-snippet-5" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int TestArrayOfStructs(MYPOINT* pPointArray, int size);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p><span id="mt37" class="sentence" data-guid="a846d4214183c74a7a119d84c9c62683" data-source="&lt;strong&gt;TestArrayOfStructs2&lt;/strong&gt; exported from PinvokeLib.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestArrayOfStructs2</strong>。</sentencetext></span></p>
    <div id="code-snippet-6" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>int TestArrayOfStructs2 (MYPERSON* pPersonArray, int size);
</pre></div>
            </div>
        </div>
    </div>
</li></ul><p><span id="mt38" class="sentence" data-guid="c45ec7fb693e47470f4621d8d91562a4" data-source="&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;PinvokeLib.dll&lt;/span&gt;&lt;/span&gt; is a custom unmanaged library that contains implementations for the previously listed functions and two structure variables, &lt;strong&gt;MYPOINT&lt;/strong&gt; and &lt;strong&gt;MYPERSON&lt;/strong&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/as6wyhwt(v=vs.110).aspx">PinvokeLib.dll</a> 是一个自定义的非托管库，它包含之前列出的函数、两个结构变量（<strong xmlns="http://www.w3.org/1999/xhtml">MYPOINT</strong> 和 <strong xmlns="http://www.w3.org/1999/xhtml">MYPERSON</strong>）的实现。</sentencetext></span><span id="mt39" class="sentence" data-guid="3ec351a038eec34bd64afb7832c249fa" data-source=" The structures contain the following elements:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 此结构包含以下元素：</sentencetext></span></p>
    <div id="code-snippet-7" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>typedef struct _MYPOINT { int x; int y; } MYPOINT; typedef struct _MYPERSON { char* first; char* last; } MYPERSON;
</pre></div>
            </div>
        </div>
    </div>
<p><span id="mt40" class="sentence" data-guid="79b85dd519f0528c4482a1366b76b361" data-source="In this sample, the &lt;span class=&quot;code&quot;&gt;MyPoint&lt;/span&gt; and &lt;span class=&quot;code&quot;&gt;MyPerson&lt;/span&gt; structures contain embedded types." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在此示例中，<span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPoint</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">MyPerson</span> 结构包含嵌入类型。</sentencetext></span><span id="mt41" class="sentence" data-guid="90adbbe7112a5ab0269194573e650cc6" data-source=" The &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;StructLayoutAttribute&lt;/span&gt;&lt;/span&gt; attribute is set to ensure that the members are arranged in memory sequentially, in the order in which they appear." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 设置 <a href="https://msdn.microsoft.com/zh-cn/library/system.runtime.interopservices.structlayoutattribute(v=vs.110).aspx">StructLayoutAttribute</a> 特性，以确保成员在内存中按照它们出现的顺序进行排列。</sentencetext></span></p><p><span id="mt42" class="sentence" data-guid="e3eb16afdbabab150c5da0ade825a14d" data-source="The &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains a set of methods called by the &lt;span class=&quot;code&quot;&gt;App&lt;/span&gt; class." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含一组 <span class="code" xmlns="http://www.w3.org/1999/xhtml">App</span> 类调用的方法。</sentencetext></span><span id="mt43" class="sentence" data-guid="5c70058f0decc4b562ac9066aae914bc" data-source=" For specific details about passing arrays, see the comments in the following sample." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 有关传递数组的特定详细信息，请参阅以下示例中的注释。</sentencetext></span><span id="mt44" class="sentence" data-guid="7394095e4811c384d5d7864be27dcc4c" data-source=" An array, which is a reference type, is passed as an In parameter by default." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 默认情况下，一个引用类型的数组将作为 In 参数进行传递。</sentencetext></span><span id="mt45" class="sentence" data-guid="0fe6cf327d9c4112f97ed129986ea0c2" data-source=" For the caller to receive the results, &lt;strong&gt;InAttribute&lt;/strong&gt; and &lt;strong&gt;OutAttribute&lt;/strong&gt; must be applied explicitly to the argument containing the array." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml"> 为使调用方接收结果，<strong xmlns="http://www.w3.org/1999/xhtml">InAttribute</strong> 和 <strong xmlns="http://www.w3.org/1999/xhtml">OutAttribute</strong> 必须显式应用于包含该数组的参数。</sentencetext></span></p></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">声明原型</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-8" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Green;">// Declares a managed structure for each unmanaged structure.</span>
[ StructLayout( LayoutKind.Sequential )]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyPoint 
{
   <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> x; 
   <span style="color:Blue;">public</span> <span style="color:Blue;">int</span> y;
   <span style="color:Blue;">public</span> MyPoint( <span style="color:Blue;">int</span> x, <span style="color:Blue;">int</span> y )
   {
      <span style="color:Blue;">this</span>.x = x;
      <span style="color:Blue;">this</span>.y = y;
   }
}
[ StructLayout( LayoutKind.Sequential, CharSet=CharSet.Ansi )]
<span style="color:Blue;">public</span> <span style="color:Blue;">struct</span> MyPerson 
{
   <span style="color:Blue;">public</span> String first; 
   <span style="color:Blue;">public</span> String last;
   <span style="color:Blue;">public</span> MyPerson( String first, String last )
   {
      <span style="color:Blue;">this</span>.first = first;
      <span style="color:Blue;">this</span>.last = last;
   }
}

<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> LibWrap
{
   <span style="color:Green;">// Declares a managed prototype for an array of integers by value.</span>
   <span style="color:Green;">// The array size cannot be changed, but the array is copied back.</span>
   [ DllImport( <span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span> )]
   <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestArrayOfInts([In, Out] <span style="color:Blue;">int</span>[] array, <span style="color:Blue;">int</span> size );

   <span style="color:Green;">// Declares a managed prototype for an array of integers by reference.</span>
   <span style="color:Green;">// The array size can change, but the array is not copied back </span>
   <span style="color:Green;">// automatically because the marshaler does not know the resulting size.</span>
   <span style="color:Green;">// The copy must be performed manually.</span>
   [ DllImport( <span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span> )]
   <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestRefArrayOfInts( <span style="color:Blue;">ref</span> IntPtr array, 
      <span style="color:Blue;">ref</span> <span style="color:Blue;">int</span> size );

   <span style="color:Green;">// Declares a managed prototype for a matrix of integers by value.</span>
   [ DllImport( <span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span> )]
   <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestMatrixOfInts([In, Out] <span style="color:Blue;">int</span>[,] pMatrix, 
      <span style="color:Blue;">int</span> row );   
   <span style="color:Green;">// Declares a managed prototype for an array of strings by value.</span>
   [ DllImport( <span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span> )]
   <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestArrayOfStrings( [In, Out] 
      String[] stringArray, <span style="color:Blue;">int</span> size );

   <span style="color:Green;">// Declares a managed prototype for an array of structures with integers.</span>
   [ DllImport( <span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span> )]
   <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestArrayOfStructs([In, Out] MyPoint[] 
      pointArray, <span style="color:Blue;">int</span> size ); 

   <span style="color:Green;">// Declares a managed prototype for an array of structures with strings.</span>
   [ DllImport( <span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span> )]
   <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">int</span> TestArrayOfStructs2( [In, Out] 
      MyPerson[] personArray, <span style="color:Blue;">int</span> size );
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">调用函数</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section">
    <div id="code-snippet-9" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> App
{
   <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
   {
      <span style="color:Green;">// array ByVal </span>
      <span style="color:Blue;">int</span>[] array1 = <span style="color:Blue;">new</span> <span style="color:Blue;">int</span>[ 10 ];
      Console.WriteLine( <span style="color:#A31515;">"Integer array passed ByVal before call:"</span> );
      <span style="color:Blue;">for</span>( <span style="color:Blue;">int</span> i = 0; i &lt; array1.Length; i++ )
      {
         array1[ i ] = i;
         Console.Write( <span style="color:#A31515;">" "</span> + array1[ i ] );
      }
      <span style="color:Blue;">int</span> sum1 = LibWrap.TestArrayOfInts( array1, array1.Length );
      Console.WriteLine( <span style="color:#A31515;">"\nSum of elements:"</span> + sum1 );
      Console.WriteLine( <span style="color:#A31515;">"\nInteger array passed ByVal after call:"</span> );

      <span style="color:Blue;">foreach</span>( <span style="color:Blue;">int</span> i <span style="color:Blue;">in</span> array1 )
      {
         Console.Write( <span style="color:#A31515;">" "</span> + i );
      }   

      <span style="color:Green;">// array ByRef </span>
      <span style="color:Blue;">int</span>[] array2 = <span style="color:Blue;">new</span> <span style="color:Blue;">int</span>[ 10 ];
      <span style="color:Blue;">int</span> size = array2.Length;
      Console.WriteLine( <span style="color:#A31515;">"\n\nInteger array passed ByRef before call:"</span> );
      <span style="color:Blue;">for</span>( <span style="color:Blue;">int</span> i = 0; i &lt; array2.Length; i++ )
      {
         array2[ i ] = i;
         Console.Write( <span style="color:#A31515;">" "</span> + array2[ i ] );
      }
      IntPtr buffer = Marshal.AllocCoTaskMem( Marshal.SizeOf( size ) 
         * array2.Length );
      Marshal.Copy( array2, 0, buffer, array2.Length );

      <span style="color:Blue;">int</span> sum2 = LibWrap.TestRefArrayOfInts( <span style="color:Blue;">ref</span> buffer, <span style="color:Blue;">ref</span> size );
      Console.WriteLine( <span style="color:#A31515;">"\nSum of elements:"</span> + sum2 );
      <span style="color:Blue;">if</span>( size &gt; 0 )
      {
         <span style="color:Blue;">int</span>[] arrayRes = <span style="color:Blue;">new</span> <span style="color:Blue;">int</span>[ size ];
         Marshal.Copy( buffer, arrayRes, 0, size );
         Marshal.FreeCoTaskMem( buffer );
         Console.WriteLine( <span style="color:#A31515;">"\nInteger array passed ByRef after call:"</span> );
         <span style="color:Blue;">foreach</span>( <span style="color:Blue;">int</span> i <span style="color:Blue;">in</span> arrayRes )
         {
            Console.Write( <span style="color:#A31515;">" "</span> + i );
         }
      }
      <span style="color:Blue;">else</span>
         Console.WriteLine( <span style="color:#A31515;">"\nArray after call is empty"</span> );

      <span style="color:Green;">// matrix ByVal </span>
      <span style="color:Blue;">const</span> <span style="color:Blue;">int</span> DIM = 5;
      <span style="color:Blue;">int</span>[,] matrix = <span style="color:Blue;">new</span> <span style="color:Blue;">int</span>[ DIM, DIM ];

      Console.WriteLine( <span style="color:#A31515;">"\n\nMatrix before call:"</span> );
      <span style="color:Blue;">for</span>( <span style="color:Blue;">int</span> i = 0; i &lt; DIM; i++ )
      {
         <span style="color:Blue;">for</span>( <span style="color:Blue;">int</span> j = 0; j &lt; DIM; j++ )
         {
            matrix[ i, j ] = j;
            Console.Write( <span style="color:#A31515;">" "</span> + matrix[ i, j ] );
         }
         Console.WriteLine( <span style="color:#A31515;">""</span> );
      }
      <span style="color:Blue;">int</span> sum3 = LibWrap.TestMatrixOfInts( matrix, DIM );
      Console.WriteLine( <span style="color:#A31515;">"\nSum of elements:"</span> + sum3 );
      Console.WriteLine( <span style="color:#A31515;">"\nMatrix after call:"</span> );
      <span style="color:Blue;">for</span>( <span style="color:Blue;">int</span> i = 0; i &lt; DIM; i++ )
      {
         <span style="color:Blue;">for</span>( <span style="color:Blue;">int</span> j = 0; j &lt; DIM; j++ )
         {
            Console.Write( <span style="color:#A31515;">" "</span> + matrix[ i, j ] );
         }
         Console.WriteLine( <span style="color:#A31515;">""</span> );
      }

      <span style="color:Green;">// string array ByVal </span>
      String[] strArray = { <span style="color:#A31515;">"one"</span>, <span style="color:#A31515;">"two"</span>, <span style="color:#A31515;">"three"</span>, <span style="color:#A31515;">"four"</span>, <span style="color:#A31515;">"five"</span> };
      Console.WriteLine( <span style="color:#A31515;">"\n\nString array before call:"</span> );
      <span style="color:Blue;">foreach</span>( String s <span style="color:Blue;">in</span> strArray )
         Console.Write( <span style="color:#A31515;">" "</span>+ s );
      <span style="color:Blue;">int</span> lenSum = LibWrap.TestArrayOfStrings( strArray, strArray.Length );
      Console.WriteLine( <span style="color:#A31515;">"\nSum of string lengths:"</span> + lenSum );
      Console.WriteLine( <span style="color:#A31515;">"\nString array after call:"</span> );
      <span style="color:Blue;">foreach</span>( String s <span style="color:Blue;">in</span> strArray )
      {
         Console.Write( <span style="color:#A31515;">" "</span> + s );
      }   

      <span style="color:Green;">// struct array ByVal </span>
      MyPoint[] points = { <span style="color:Blue;">new</span> MyPoint(1,1), <span style="color:Blue;">new</span> MyPoint(2,2), <span style="color:Blue;">new</span> MyPoint(3,3) };
      Console.WriteLine( <span style="color:#A31515;">"\n\nPoints array before call:"</span> );
      <span style="color:Blue;">foreach</span>( MyPoint p <span style="color:Blue;">in</span> points )
         Console.WriteLine( <span style="color:#A31515;">"x = {0}, y = {1}"</span>, p.x, p.y );
      <span style="color:Blue;">int</span> allSum = LibWrap.TestArrayOfStructs( points, points.Length );
      Console.WriteLine( <span style="color:#A31515;">"\nSum of points:"</span> + allSum );
      Console.WriteLine( <span style="color:#A31515;">"\nPoints array after call:"</span> );
      <span style="color:Blue;">foreach</span>( MyPoint p <span style="color:Blue;">in</span> points )
         Console.WriteLine( <span style="color:#A31515;">"x = {0}, y = {1}"</span>, p.x, p.y );      

      <span style="color:Green;">// struct with strings array ByVal </span>
      MyPerson[] persons = { <span style="color:Blue;">new</span> MyPerson( <span style="color:#A31515;">"Kim"</span>, <span style="color:#A31515;">"Akers"</span> ), 
      <span style="color:Blue;">new</span> MyPerson( <span style="color:#A31515;">"Adam"</span>, <span style="color:#A31515;">"Barr"</span> ), <span style="color:Blue;">new</span> MyPerson( <span style="color:#A31515;">"Jo"</span>, <span style="color:#A31515;">"Brown"</span> )};

      Console.WriteLine( <span style="color:#A31515;">"\n\nPersons array before call:"</span> );
      <span style="color:Blue;">foreach</span>( MyPerson pe <span style="color:Blue;">in</span> persons )
        Console.WriteLine( <span style="color:#A31515;">"first = {0}, last = {1}"</span>, pe.first, pe.last );
      <span style="color:Blue;">int</span> namesSum = LibWrap.TestArrayOfStructs2( persons, persons.Length );
      Console.WriteLine( <span style="color:#A31515;">"\nSum of name lengths:"</span> + namesSum );
      Console.WriteLine( <span style="color:#A31515;">"\n\nPersons array after call:"</span> );
      <span style="color:Blue;">foreach</span>( MyPerson pe <span style="color:Blue;">in</span> persons )
        Console.WriteLine( <span style="color:#A31515;">"first = {0}, last = {1}"</span>, pe.first, pe.last );
   }
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">请参阅</span></a><div id="Anchor_1" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/hk9wyw21(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_1" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><p><a href="https://msdn.microsoft.com/zh-cn/library/dd93y453(v=vs.110).aspx">封送类型数组</a><br><a href="https://msdn.microsoft.com/zh-cn/library/ac7ay120(v=vs.110).aspx">平台调用数据类型</a><br><a href="https://msdn.microsoft.com/zh-cn/library/w4byd5y4(v=vs.110).aspx">在托管代码中创建原型</a><br></p></div></div></div>
    </div>
  </div>
</div>
  

    </div>



        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="kd3-HV89qh7Jq7-Tu6ONPFHM-08gP5GxVDhYZhnCwWw5pX5jSN_9E1MyOa0Vq16pKtG5N8sCiWXD6mlHFO9GsAkXL7I1">
<input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/rate/hk9wyw21(d=printer,v=vs.110).aspx">
<input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/additional/hk9wyw21(d=printer,v=vs.110).aspx">
<input id="isTopicRated" type="hidden" value="false">




    <div id="lib-footer">
        

    
    <link type="text/css" rel="stylesheet">
    
    <div id="ux-footer" class="" style="" dir="ltr">


    <div id="standardRatingBefore" class="clear stdr-container-before"></div>
    <div id="standardRating" class="stdr-container" ms.pgarea="body">
        <div class="stdr-close"></div>
        <div class="stdr-vote stdr-content">
            <div class="stdr-content">
                <span class="stdr-votetitle">此页面有帮助吗？</span>
                <button class="stdr-yes" aria-label="是，此页面很有帮助">是</button>
                <button class="stdr-no" aria-label="不，此页面没有任何帮助">否</button>
                <input id="s_ratingValue" type="hidden" value="">
            </div>
        </div>
        <div class="stdr-feedback" style="display: none">
            <div class="stdr-form">
                <div class="stdr-fieldtitle">更多反馈？</div>
                <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea>
                <div>
                    <span class="stdr-count"><span class="stdr-charcnt">1500</span> 个剩余字符</span>
                    <div class="stdr-buttons">
                        <button class="stdr-provide" aria-label="提交我的其他反馈">提交</button>
                        <button class="stdr-skip" aria-label="跳过其他反馈">跳过此步</button>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div class="stdr-thanks" style="display: none">
            <div class="stdr-content">
                <span class="stdr-thankyou">谢谢！</span>
                <span class="stdr-appreciate">我们非常感谢您的反馈。</span>
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
    <div id="standardRatingPlaceholder" style="display: none"></div>
    

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">开发人员中心</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/zh-cn/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">更多...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">学习资源</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft 虚拟学院</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">第 9 频道</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN 杂志</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">社区</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/zh-cn/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">论坛</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">博客</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">支持</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">自助支持</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">计划</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark（针对新创企业）</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">创新杯</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/zh-cn/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2fhk9wyw21(d%3dprinter%2cv%3dvs.110).aspx%3flan%3dCSharp%26cc%3dn%26trm%3dtra%26view%3dbook">
        <a href="http://msdn.microsoft.com/#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="更改您的语言">中国 (简体中文)</a>
    </form>


            </span>

            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">新闻稿</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">隐私&amp; Cookie</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">使用条款</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">商标</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2016 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>


        <div class="footerPrintView">
            <div class="footerCopyrightPrintView">© 2016 Microsoft</div>
        </div>

        
        

        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17">



        <input id="MtpsDevice" type="hidden" value="Printer">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

        
        
        
            
        






<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="https://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>








<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="fNTTJkQubZMEoxZ_Q1LQimgz4R43kEGT564wMXUZjxHRAcsfVR_Dauvu6vIk1kO4jzyo-mWb8cNYwVJshHPocit0-201">
</div>


    </div>

    
    

    

    
    
    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/zh-cn/library/hk9wyw21(d=printer,l=zh-cn,v=vs.110).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027zh-cn\u0027;\n  var wtsp = \u0027msdnlib_dotnet\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:StandardRating,2:Footer,0:Topic,4:PabTopic,5:webtrendsscript,0:AppInsightsPerf,0:ABTestControl,6:WEDCS,4:CmpgrpForHeader,0:livefyre,0:Comment,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Global/Content:3,/Areas/Library/Content:4,/Areas/Global/Content/Webtrends/resources:5,/Areas/Library/Themes/Base/Content:6\u0026amp;hashKey=BA9931020C89561F32DF1A9F4D3D9490\u0026amp;v=C1A44C493A8E2B533F677094B680D091" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026pgArea=header\u0026brand=Msdn\u0026loc=zh-cn\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=搜索 MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:JumpRedirect,1:PrintExportButton;/Areas/Epx/Themes/Base/Content:0,/Areas/Library/Themes/Base/Content:1\u0026amp;hashKey=7006119E9942EFE11F58E00EDB773584\u0026amp;v=C1A44C493A8E2B533F677094B680D091" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Toc_Fixed,0:CodeSnippet,0:TopicNotInScope,0:CollapsibleArea,0:VersionSelector,0:SurveyBroker;/Areas/Epx/Content/Scripts:0\u0026amp;hashKey=928842C6187B6959419CA6E8B32D31AC\u0026amp;v=C1A44C493A8E2B533F677094B680D091" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>
<link rel="stylesheet" type="text/css" href="./我的集合_files/Combined.css">
    <div id="page">

        

        
    

    
    <link type="text/css" rel="stylesheet">
    
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn">
        

      <header>
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/zh-cn" title="MSDN home">
                  <div id="msft-logo" class="msft-logo"></div>
                </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/zh-cn">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <div class="profileImage"></div>



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=12&ct=1464504571&rver=6.0.5276.0&wp=mcmbi&wlcxt=msdn%24msdn%24msdn&wreply=https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2f5zwkzwf4%2528d%3dprinter%2cv%3dvs.110%2529.aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook&lc=2052&id=254354&mkt=zh-cn">登录</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">MSDN 订阅</span>
  </a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x804&slcid=0x804&campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">获取工具</span>
  </a>
</div>
                  </div>                    
                        <div>
                            <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.weibo.com/cnmsdn" id="SocialLinks_2152_8" class="weiboShare" xmlns="http://www.w3.org/1999/xhtml">http://www.weibo.com/cnmsdn</a>
      </li>
      <li>
        <a href="http://aka.ms/msdnwechat" id="SocialLinks_2152_9" class="wechatShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/msdnwechat</a>
      </li>
      <li>
        <a href="http://aka.ms/contactmsdn" id="SocialLinks_2152_10" class="cnContactShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/contactmsdn</a>
      </li>
    </ul>
  </div>
</div>
                        </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">技术</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="云">云</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="应用开发">应用开发</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="数据">数据</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="游戏">游戏</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/internetofthings" title="物联网">物联网</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">下载</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions/" title="MSDN 订阅访问">MSDN 订阅访问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDK">SDK</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="试用软件">试用软件</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="免费下载">免费下载</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office 资源">Office 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 资源">SharePoint Server 2013 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express 资源">SQL Server 2014 Express 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 资源">Windows Server 2012 资源</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">计划</a>
                                <ul class="navL2">
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN 订阅">MSDN 订阅</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="权益">权益</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="学生">学生</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft 学生合作伙伴">Microsoft 学生合作伙伴</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="架构师">架构师</a>

                                                <ul class="navL3">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="案例研究">案例研究</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="蓝图">蓝图</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="博客">博客</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="论坛">论坛</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/applicationbuilder" title="ISV">ISV</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="新手">新手</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="TechRewards">TechRewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/zh-cn" title="Events（事件）">Events（事件）</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">社区</a>
                                <ul class="navL2">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="论坛">论坛</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://blogs.msdn.microsoft.com/" title="博客">博客</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/zh-cn" title="技术顾问">技术顾问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="第 9 频道">第 9 频道</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)">文档</a>
                                <ul class="navL2">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="API 和参考">API 和参考</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="开发人员中心">开发人员中心</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/">示例</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)">
      </div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    </div>

    
    
    
    <div id="jumpInfo" style="display: none">非常抱歉。你请求的内容已被删除。将在 1 秒内自动重定向。</div>


    
    <div class="printExportMenus ltr">
        <a id="isd_printABook" href="http://msdn.microsoft.com/zh-cn/library/export/help/(d=printer)?returnurl=%2fzh-cn%2flibrary%2f5zwkzwf4(d%3dprinter,v%3dvs.110).aspx%3flan%3dcsharp%26cc%3dn%26trm%3dtra%26view%3dbook">
            导出 (<span class="count">0</span>)
        </a>
        <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/5zwkzwf4(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book" rel="nofollow">
            打印
        </a>
        <a id="isd_archiveControl" style="display:none;" data-include-archive="显示已存档版本" data-exclude-archive="隐藏已存档版本">
        </a>
    </div>
    
    <div class="printExportMenus ltr">
        <a id="expandCollapseAll" accesskey="e" href="javascript:void(0)" title="Expand/Collapse all sections by pressing Ctrl + Shift + e">全部展开</a>
    </div>

    


        <div id="body" ms.pgarea="body">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="content" class="content">



<input type="hidden" id="printForPab" value="true">



        
<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">将委托作为回调方法进行封送</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong>
                .NET Framework (current version)
            </strong>
      </div>
      <div id="versionclick">
        <div id="vsseperator" class="cl_lw_vs_seperator"></div>
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        其他版本
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./我的集合_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel">
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/5zwkzwf4(d=printer,v=vs.100).aspx">.NET Framework 4</a>
          </li>
          <li class="">
            <a href="http://msdn.microsoft.com/zh-cn/library/5zwkzwf4(d=printer,v=vs.90).aspx">.NET Framework 3.5</a>
          </li>
          <li class="archived">
            <a href="http://msdn.microsoft.com/zh-cn/library/5zwkzwf4(d=printer,v=vs.80).aspx">.NET Framework 2.0</a>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<div class="introduction"><p>
      <span id="mt1" class="sentence" data-guid="9138ad5d164bd42e2f8e57ef4c6e53be" data-source="This sample demonstrates how to pass delegates to an unmanaged function expecting function pointers." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">该示例说明如何将委托传递给需要函数指针的非托管函数。</sentencetext></span>  <span id="mt2" class="sentence" data-guid="d23eacdc5cd623075abb9c82ef418be3" data-source="A delegate is a class that can hold a reference to a method and is equivalent to a type-safe function pointer or a callback function." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">委托是可以容纳对方法的引用的类，并且等效于类型安全函数指针或回调函数。</sentencetext></span>  </p><div class="alert"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note" alt="System_CAPS_note" src="./我的集合_files/5zwkzwf4.s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note(v=vs.110).jpeg" title="System_CAPS_note" xmlns=""></span><span class="alertTitle">注意</span></th></tr><tr><td><p>
        <span id="mt3" class="sentence" data-guid="d1f40cdd07007d82aaa576c2f4a94423" data-source="When you use a delegate inside a call, the common language runtime protects the delegate from being garbage collected for the duration of that call." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">当您在调用内部使用委托时，公共语言运行时将在该调用的持续时间内防止对委托执行垃圾回收。</sentencetext></span>  <span id="mt4" class="sentence" data-guid="71dc1315a50fb77bb233ecd3a3f4cf66" data-source="However, if the unmanaged function stores the delegate to use after the call completes, you must manually prevent garbage collection until the unmanaged function finishes with the delegate." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">但是，如果非托管函数存储该委托以供在该调用完成后使用，则您必须手动防止进行垃圾回收，直到非托管函数完成对该委托的使用为止。</sentencetext></span>  <span id="mt5" class="sentence" data-guid="709cac0741efbc4f0d94f0d88b8a4064" data-source="For more information, see the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;HandleRef Sample&lt;/span&gt;&lt;/span&gt; and &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;GCHandle Sample&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">有关更多信息，请参见 <a href="https://msdn.microsoft.com/zh-cn/library/hc662t8k(v=vs.110).aspx">HandleRef 示例</a>和 <a href="https://msdn.microsoft.com/zh-cn/library/44ey4b32(v=vs.110).aspx">GCHandle 示例</a>。</sentencetext></span>  </p></td></tr></tbody></table></div><p>
      <span id="mt6" class="sentence" data-guid="7758ca77d23f11866e0b5a2b2f1864ba" data-source="The Callback sample uses the following unmanaged functions, shown with their original function declaration:  " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">Callback 示例使用以下非托管函数（这里同时显示其原始函数声明）：</sentencetext></span>
    </p><ul class="unordered"><li><p>
          <span id="mt7" class="sentence" data-guid="da5eb2ef1f1505f080f75395361e38cf" data-source="&lt;strong&gt;TestCallBack&lt;/strong&gt; exported from PinvokeLib.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestCallBack</strong>。</sentencetext></span>
        </p>
    <div id="code-snippet-1" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>void TestCallBack(FPTR pf, int value);
</pre></div>
            </div>
        </div>
    </div>
</li><li><p>
          <span id="mt8" class="sentence" data-guid="0498fbbc6a24c2c6922ac63e2aab941f" data-source="&lt;strong&gt;TestCallBack2&lt;/strong&gt; exported from PinvokeLib.dll. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">从 PinvokeLib.dll 导出的 <strong xmlns="http://www.w3.org/1999/xhtml">TestCallBack2</strong>。</sentencetext></span>
        </p>
    <div id="code-snippet-2" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a></a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre>void TestCallBack2(FPTR2 pf2, char* value);
</pre></div>
            </div>
        </div>
    </div>
</li></ul><p>
      <span id="mt9" class="sentence" data-guid="4fec12157def31a85296fbff6e7c7ea0" data-source="&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;PinvokeLib.dll&lt;/span&gt;&lt;/span&gt; is a custom unmanaged library that contains an implementation for the previously listed functions." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/zh-cn/library/as6wyhwt(v=vs.110).aspx">PinvokeLib.dll</a> 是一个自定义非托管库，它包含前面列出的函数的实现。</sentencetext></span>
    </p><p>
      <span id="mt10" class="sentence" data-guid="93d87191c71a1d28544f12615ab2e1e5" data-source="In this sample, the &lt;span class=&quot;code&quot;&gt;LibWrap&lt;/span&gt; class contains managed prototypes for the &lt;span class=&quot;code&quot;&gt;TestCallBack&lt;/span&gt; and &lt;span class=&quot;code&quot;&gt;TestCallBack2&lt;/span&gt; methods." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">在该示例中，<span class="code" xmlns="http://www.w3.org/1999/xhtml">LibWrap</span> 类包含 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestCallBack</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">TestCallBack2</span> 方法的托管原型。</sentencetext></span>  <span id="mt11" class="sentence" data-guid="1b03ed5f2c75d75016d9f8d5918d4f94" data-source="Both methods pass a delegate to a callback function as a parameter." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">这两个方法都将委托作为参数传递给回调函数。</sentencetext></span>  <span id="mt12" class="sentence" data-guid="e247f259b6574ac43d10b1697e24a249" data-source="The signature of the delegate must match the signature of the method it references." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">该委托的签名必须与它所引用的方法的签名相匹配。</sentencetext></span>  <span id="mt13" class="sentence" data-guid="1fdff85798d5cda85b33c0c8b8217dd1" data-source="For example, the &lt;span class=&quot;code&quot;&gt;FPtr&lt;/span&gt; and &lt;span class=&quot;code&quot;&gt;FPtr2&lt;/span&gt; delegates have signatures that are identical to the &lt;span class=&quot;code&quot;&gt;DoSomething&lt;/span&gt; and &lt;span class=&quot;code&quot;&gt;DoSomething2&lt;/span&gt; methods." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">例如，<span class="code" xmlns="http://www.w3.org/1999/xhtml">FPtr</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">FPtr2</span> 委托的签名与 <span class="code" xmlns="http://www.w3.org/1999/xhtml">DoSomething</span> 和 <span class="code" xmlns="http://www.w3.org/1999/xhtml">DoSomething2</span> 方法的签名相同。</sentencetext></span>  </p></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">声明原型</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/5zwkzwf4(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section">
    <div id="code-snippet-3" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">delegate</span> <span style="color:Blue;">bool</span> FPtr(<span style="color:Blue;">int</span> value);
<span style="color:Blue;">public</span> <span style="color:Blue;">delegate</span> <span style="color:Blue;">bool</span> FPtr2(<span style="color:Blue;">string</span> value);

<span style="color:Blue;">public</span> <span style="color:Blue;">class</span> LibWrap
{
    <span style="color:Green;">// Declares managed prototypes for unmanaged functions.</span>
    [DllImport(<span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> TestCallBack(FPtr cb, <span style="color:Blue;">int</span> value);

    [DllImport(<span style="color:#A31515;">"..\\LIB\\PinvokeLib.dll"</span>)]
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">extern</span> <span style="color:Blue;">void</span> TestCallBack2(FPtr2 cb2, String value);
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">调用函数</span></a><div id="Anchor_1" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/5zwkzwf4(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_1" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section">
    <div id="code-snippet-4" class="codeSnippetContainer" xmlns="http://www.w3.org/1999/xhtml">
        <div class="codeSnippetContainerTabs">
            <div class="codeSnippetContainerTab codeSnippetContainerTabActive" dir="ltr">
                <a>C#</a>
            </div>
        </div>
        <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"></div> 
            <div class="codeSnippetContainerCode" dir="ltr">
                <div style="color:Black;"><pre><span style="color:Blue;">public</span> <span style="color:Blue;">class</span> App
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">void</span> Main()
    {
        FPtr cb = <span style="color:Blue;">new</span> FPtr(App.DoSomething);
        LibWrap.TestCallBack(cb, 99);
        FPtr2 cb2 = <span style="color:Blue;">new</span> FPtr2(App.DoSomething2);
        LibWrap.TestCallBack2(cb2, <span style="color:#A31515;">"abc"</span>);
    }

    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">bool</span> DoSomething(<span style="color:Blue;">int</span> value)
    {
        Console.WriteLine(<span style="color:#A31515;">"\nCallback called with param: {0}"</span>, value);
        <span style="color:Green;">// ...</span>
        <span style="color:Blue;">return</span> <span style="color:Blue;">true</span>;
    }

    <span style="color:Blue;">public</span> <span style="color:Blue;">static</span> <span style="color:Blue;">bool</span> DoSomething2( String value )
    {
        Console.WriteLine(<span style="color:#A31515;">"\nCallback called with param: {0}"</span>, value);
        <span style="color:Green;">// ...</span>
        <span style="color:Blue;">return</span> <span style="color:Blue;">true</span>;
    }
}
</pre></div>
            </div>
        </div>
    </div>
</div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">请参阅</span></a><div id="Anchor_2" class="LW_CollapsibleArea_Anchor_Div"><a href="http://msdn.microsoft.com/zh-cn/library/5zwkzwf4(d=printer,v=vs.110).aspx?lan=csharp&cc=n&trm=tra&view=book#Anchor_2" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><p><a href="https://msdn.microsoft.com/zh-cn/library/ss9sb93t(v=vs.110).aspx">Miscellaneous Marshaling Samples</a><br><a href="https://msdn.microsoft.com/zh-cn/library/ac7ay120(v=vs.110).aspx">Platform Invoke Data Types</a><br><a href="https://msdn.microsoft.com/zh-cn/library/w4byd5y4(v=vs.110).aspx">在托管代码中创建原型</a><br></p></div></div></div>
    </div>
  </div>
</div>
  

    </div>



        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="yUQUczIop8z0iFFGW91Ka3IDkWeVDlQZLvUvsPPtdxpgQfqu1QLAZqbun5lPcJ7RWrH2ARHKBm1JD6qvDdSL6QCsW981">
<input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/rate/5zwkzwf4(d=printer,v=vs.110).aspx">
<input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/additional/5zwkzwf4(d=printer,v=vs.110).aspx">
<input id="isTopicRated" type="hidden" value="false">




    <div id="lib-footer">
        

    
    <link type="text/css" rel="stylesheet">
    
    <div id="ux-footer" class="" style="" dir="ltr">


    <div id="standardRatingBefore" class="clear stdr-container-before"></div>
    <div id="standardRating" class="stdr-container" ms.pgarea="body">
        <div class="stdr-close"></div>
        <div class="stdr-vote stdr-content">
            <div class="stdr-content">
                <span class="stdr-votetitle">此页面有帮助吗？</span>
                <button class="stdr-yes" aria-label="是，此页面很有帮助">是</button>
                <button class="stdr-no" aria-label="不，此页面没有任何帮助">否</button>
                <input id="s_ratingValue" type="hidden" value="">
            </div>
        </div>
        <div class="stdr-feedback" style="display: none">
            <div class="stdr-form">
                <div class="stdr-fieldtitle">更多反馈？</div>
                <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea>
                <div>
                    <span class="stdr-count"><span class="stdr-charcnt">1500</span> 个剩余字符</span>
                    <div class="stdr-buttons">
                        <button class="stdr-provide" aria-label="提交我的其他反馈">提交</button>
                        <button class="stdr-skip" aria-label="跳过其他反馈">跳过此步</button>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div class="stdr-thanks" style="display: none">
            <div class="stdr-content">
                <span class="stdr-thankyou">谢谢！</span>
                <span class="stdr-appreciate">我们非常感谢您的反馈。</span>
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
    <div id="standardRatingPlaceholder" style="display: none"></div>
    

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">开发人员中心</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/zh-cn/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">更多...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">学习资源</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft 虚拟学院</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">第 9 频道</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN 杂志</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">社区</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/zh-cn/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">论坛</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">博客</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">支持</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">自助支持</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">计划</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark（针对新创企业）</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">创新杯</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/zh-cn/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2f5zwkzwf4(d%3dprinter%2cv%3dvs.110).aspx%3flan%3dCSharp%26cc%3dn%26trm%3dtra%26view%3dbook">
        <a href="http://msdn.microsoft.com/#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="更改您的语言">中国 (简体中文)</a>
    </form>


            </span>

            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">新闻稿</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">隐私&amp; Cookie</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">使用条款</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">商标</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2016 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>


        <div class="footerPrintView">
            <div class="footerCopyrightPrintView">© 2016 Microsoft</div>
        </div>

        
        

        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17">



        <input id="MtpsDevice" type="hidden" value="Printer">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

        
        
        
            
        






<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="https://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>








<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="kCEiGWGcBljoxYmZW5X8qtuayue7h-R-6wkSlUhb2ovVQm7RVWvlcTvjohxWKmuD8VTj-Qkn85XmN9uy24gpDESmlVM1">
</div>


    </div>

    
    

    

    
    
    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/zh-cn/library/5zwkzwf4(d=printer,l=zh-cn,v=vs.110).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027zh-cn\u0027;\n  var wtsp = \u0027msdnlib_dotnet\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:StandardRating,2:Footer,0:Topic,4:PabTopic,5:webtrendsscript,0:AppInsightsPerf,0:ABTestControl,6:WEDCS,4:CmpgrpForHeader,0:livefyre,0:Comment,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Global/Content:3,/Areas/Library/Content:4,/Areas/Global/Content/Webtrends/resources:5,/Areas/Library/Themes/Base/Content:6\u0026amp;hashKey=BA9931020C89561F32DF1A9F4D3D9490\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026pgArea=header\u0026brand=Msdn\u0026loc=zh-cn\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=搜索 MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:JumpRedirect,1:PrintExportButton;/Areas/Epx/Themes/Base/Content:0,/Areas/Library/Themes/Base/Content:1\u0026amp;hashKey=7006119E9942EFE11F58E00EDB773584\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Toc_Fixed,0:CodeSnippet,0:TopicNotInScope,0:CollapsibleArea,0:VersionSelector,0:SurveyBroker;/Areas/Epx/Content/Scripts:0\u0026amp;hashKey=928842C6187B6959419CA6E8B32D31AC\u0026amp;v=9352FEAE309393DA781F25BCE4490CE7" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>


<div style="position: static; width: 0px; height: 0px; border: none; padding: 0px; margin: 0px;"><div id="trans-tooltip"><div id="tip-left-top" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-left-top.png);"></div><div id="tip-top" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-top.png) repeat-x;"></div><div id="tip-right-top" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-right-top.png);"></div><div id="tip-right" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-right.png) repeat-y;"></div><div id="tip-right-bottom" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-right-bottom.png);"></div><div id="tip-bottom" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-bottom.png) repeat-x;"></div><div id="tip-left-bottom" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-left-bottom.png);"></div><div id="tip-left" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-left.png);"></div><div id="trans-content"></div></div><div id="tip-arrow-bottom" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-arrow-bottom.png);"></div><div id="tip-arrow-top" style="background: url(chrome-extension://ikkepelhgbcgmhhmcmpfkjmchccjblkd/imgs/map/tip-arrow-top.png);"></div></div></body></html>